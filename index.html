<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="读书、写字、周游天下...">
<meta property="og:type" content="website">
<meta property="og:title" content="Joey  chang's  blog">
<meta property="og:url" content="http://ijoeychang.github.io/index.html">
<meta property="og:site_name" content="Joey  chang's  blog">
<meta property="og:description" content="读书、写字、周游天下...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Joey  chang's  blog">
<meta name="twitter:description" content="读书、写字、周游天下...">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Joey  chang's  blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?7051b02e64de9396c8130272189f6a4d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Joey  chang's  blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-user fa-fw"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/20/2018/时间过得真快/" itemprop="url">
                  时间过得真快
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-05-20T00:00:00+08:00" content="2018-05-20">
              2018-05-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/我的随笔/" itemprop="url" rel="index">
                    <span itemprop="name">我的随笔</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/05/20/2018/时间过得真快/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/05/20/2018/时间过得真快/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          

          


          
           

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>时间过得可真快啊，这一天一天的，感觉每天都是还没怎么做事情就结束了。想想有点可怕。</p>
<p>今天是万民过的节日，巧了，也是我的生日。现在我还在公司，等下早点回去买个蛋糕庆祝一下。虽然年龄越来越大，越来越不想过生日，因为每逢生日老一岁，但生活还是得有点仪式感的。</p>
<p>时间过得快，之前很长一段时间都让我感到很焦虑，因为年龄大的缘故，也因为一直一无所成，真有点急人。每天机械的上班，总是看不到进步，一副无所事事的样子，这不是我想看到的。每当夜深人静的时候，我总会想，这已过去的一天，我有什么收获呢？如果能够有些明显且能感觉到的收获，我会很欣慰，如果一直觉得空度日子，我又会很难受。</p>
<p>最近几天，我开始对自己的学习方法以及做事方式进行反思。我觉得就写作这一块儿，我应该厚点脸皮，之前不是没有写，而是差不多每周都有写，但是有些内容感觉发出来让熟识的人看到了会不好意思。很多时候，我会以日记方式记录下来。当然，我也承认，有些内心的真实想法是真不适合公开来说的，但是，练笔这个过程是不应该间断的。坚持了近半年的练习英语听说，每周至少五天，每天至少半小时，半年来，鲜有间断，一直感觉进步很慢，但是昨天突然就感到效果良好了。昨天的学习成绩不错。我想只要一直坚持下去，我会进步很大的。人做事情，总是三分钟热度的多，所谓善始者实繁克终者盖寡是也。如果一直坚持着做一件事，一年又一年，日积月累，滴水也能穿石呢。所以，坚持，用心做一件事，真的很重要。学习英语是这样，写作也是。</p>
<p>之前很多次作文，一旦我写起来，我会控制不住长度，总是一篇文章写很多字，又会花费很多时间，我想如果谁能够读完，那真是真爱啊。自己开始也没期望多少人会看，我写文的初始动机只是作为一个生活的记录给未来的自己看。不曾想，写出来发在网上的东西，有时写的稍好一点，还是会有很多人看到的。这个也算是一种正激励吧。正反馈可以让我更多更认真的写下去。</p>
<p>昨日去练车，教练竟然主动和我聊起了新疆，他说他读了我写的那篇很长的游记，还微信收藏了，我有点意外，心想，“我们不是一个时代的人啊，竟然喜欢我写的不成熟的游记”，他还说，“只有两天时间就写那么多，如果自驾游玩个半个月一个月的，那你得写多少字啊？” 他聊起旅游和历史，我有话题了，我就和他上下五千年侃了起来。没想到他一个驾校教练，年龄五十岁左右了，竟然对历史很感兴趣且很有研究。我对他说，“其实我想考驾照，就是希望有一天租个车，去西藏或者新疆转转，开车自驾游，那多酷啊！” </p>
<p>说真的，我对汽车不感冒，但是对开车去浪，是期盼已久了。很多年前，当我站在高速公路的桥梁上，看着来来往往的车辆，我就想，“有一天，我一定要开着车去向很远很远的地方…”</p>
<p>因为与教练的聊天，我觉得以后我应该再频繁点发文章，只是每次要刻意控制点长度了，每次不能花费太多时间，不然会影响到做其它事情。</p>
<p>读书、旅行、写作，这是我比较喜欢的生活方式，每个方向，我都要用心去经营。</p>
<p>努力方向和学习方式很重要，我得多向行业内厉害的行家里手们学习，做事要高效率，学习也得高效率。或者学习的最快方式就是找一个厉害的行家作为对比，向他学习。</p>
<p>有时想想，如果生活中能够有个前辈对你指点、照顾，那真的会让你少走很多弯路。</p>
<p>一点点练笔，收拾收拾，下班回去买蛋糕了。</p>
<p>2018.05.20<br>上海 虹桥</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/05/06/2018/天山戈壁乌鲁木齐/" itemprop="url">
                  天山戈壁乌鲁木齐
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-05-06T15:12:00+08:00" content="2018-05-06">
              2018-05-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/周游天下/" itemprop="url" rel="index">
                    <span itemprop="name">周游天下</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/05/06/2018/天山戈壁乌鲁木齐/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/05/06/2018/天山戈壁乌鲁木齐/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          

          


          
           

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>清明节三天，去了趟乌鲁木齐。在那里玩得很好，有点不想回来的感觉。</p>
<p>每次去一个远方，其实都会觉得很累，早上要早起，晚上回来的很晚，又要晚睡，白天里为了多看点风景，还要不停地赶路，身体其实是很累的。有的人不喜欢旅行，可能会觉得大周末的还不如睡个懒觉舒服呢，去什么远方，去什么流浪。可是我觉得呢，去一个陌生的地方，看陌生的人群，看陌生的风土人情，每隔一段时间跳出自己当前的生活环境，去呼吸一下不一样的空气，那样的感觉很酷。再有就是，平常的日子太单调了，我很不希望多年之后再回忆往事的时候，生活里除了工作加班之外是一片空白，那样活着就太无趣了吧。至今我还会时常想起去年去香港时在维多利亚港拍的照片，我想多年后再回忆会更有感觉。多么美好的回忆啊。</p>
<p>偶尔出去走一走，看一看，给单调乏味的日子来点调料，为远方和诗找点素材，是谓采风，也是给日常疲惫的身心一点休息。</p>
<p>闲言少叙，继续回到乌鲁木齐之行来。本来这次还是我一个人出去浪的，但是当距离出发日还有一周左右时间，同事雪健问我清明节时候有没有出行打算，我说了我的计划，然后他也跟着去了。</p>
<p>出发的当天，我早上五点半起床，六点半开始向机场赶，因为住处距离机场很近，骑车十几分钟就到了，开始我没太当回事儿，以致当天差一点错过航班。当我登机后仅仅十几分钟飞机就起飞了。时间赶得紧，坐上飞机我长舒了一口气。平常起床晚，为了出去玩儿，早上起这么早，开始感觉还真痛苦。好在上飞机后可以继续睡。</p>
<p>从上海飞到乌鲁木齐，直飞的话需要五个多小时，而我司的航班当天只有两条，直飞的在下午，为了多出一点游玩时间，我选择了一大早出发，不过这样的话需要中转到西安，耗时七个多小时。开始觉得坐飞机很累，不过想想第一次去那么远的地方，又很兴奋。</p>
<p>当飞机快要到乌鲁木齐的时候，我透过窗看到了雪山，然后我的困意立刻没了，我感到有些振奋，赶快拿出手机拍照、录像。山上白茫茫一片，经过阳光反射，非常的白，像一层层盐，我有些不确定它们是不是雪。</p>
<p>在飞机上面看下面，千山负雪的盛景，非常震撼。</p>
<p>早上七点多出发，到达乌鲁木齐已经下午两点四十了。假期三天，第一天已经耗去大半，我和雪健一下飞机就赶快向市区赶。来的时候没有做太多的功课，我们两个没有想好小半天的时间可以去哪里，最后我说，我们去博物馆吧，雪健没意见。</p>
<p>每到一个陌生的城市，我喜欢去逛他们的博物馆。我觉得旅行和读书差不多一样，都是获得知识的过程，而博物馆，无疑是增长知识的好地方。来的时候，因为和雪健一起，开始我还担心他不想去博物馆，还担心这次去不了博物馆了，如果是那样，我一定会感到遗憾，好在第一天我们就去了博物馆。</p>
<p>新疆博物馆不算大，但是外表看起来还是挺壮观的，它简洁、大方。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-331bd0a91cdf7b5c.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="博物馆"></p>
<p>我们刚进去的时候，已经下午四点，记得上海博物馆下午五点闭馆，我想我们可以看的时间会非常短，所以我一直催着赶快，虽然当时我们都很饿，但匆匆买了点零食就直奔博物馆了。</p>
<p>进大门的时候需要过安检，新疆那边管得很严，第二天我才真正体会到有多严，酒店、公园、景区、超市、菜市场处处要过安检，每个十字路口都有数名武装警察，很多地方还是真枪实弹的特警。这个时候，稳定压倒一切。</p>
<p>过安检的时候，问了下师傅闭馆时间，得知是五点半，然后有点小庆幸，觉得又可以多出半小时在里面观看了。</p>
<p>博物馆分两层，第一层是古代的一些文物展览，第二次就有点瘆人了，因为整个二楼，摆满了各种干尸，这些干尸应该是博物馆的镇馆之宝。他们来自远古，有的都有三千多年了，如果时间是真的，真不敢想象经过这么多年，他们的尸身还能保存那么好。干尸中还有小孩子，看着那一个个干尸，不禁有点怅然。旅客中有的姑娘竟然摆着 pose 在和他们一个个合照，我感觉不太好，然后连照片都没有拍。如果世间存有灵魂，我想那些前人是不愿被后人打扰的吧。身在历史的长河中，不禁让人想生命到底是怎么一回事呢。</p>
<p>对干尸有兴趣的朋友可以网上搜索一下看看。这里就不放照片了。</p>
<p>在博物馆待了一个多小时，由于博物馆不大，时间已经很充裕了。</p>
<p>离开博物馆，时间已经快六点了，而那时的太阳还很毒辣，想着时间还早，我们就去附近最近的景区转了转。</p>
<p>地图上看着是风景区，到现场却很失望。眼前不是绿油油的春意融融，而是一座小山，光秃秃的，向前延伸很远。我俩顺着山路走了大概一个小时，看到了完全不同于内地的西域风光。小山上看到一两个小亭子，它们也是西方建筑风格。</p>
<p>晚饭和雪健一起吃了大盘鸡。记得上大学时在郑州经常吃大盘鸡，还以为那菜是我们那里的，不曾想新疆大盘鸡更有名。我们两个人要了份儿中盘的，菜很好吃，却没有吃完，因为量很大。</p>
<p>吃过饭，问店老板去天山该怎么坐车。老板和老板娘很热情的解答。没去新疆之前，总觉得那里会不安全，觉得当地人对内地人不友好，但是问路几次，又觉得当地人大多是很友好的。</p>
<p>翌日清晨八点，我和同事就离开酒店去红山公园门口等待去天山的巴士。八点，我觉得已经很晚了，可是大街上却只能看到些许晨跑的极少行人。我在纳闷，同学黄瑞发微信说她也在乌鲁木齐，我感到非常意外，老家的小伙伴，怎么跑这么远来乌鲁木齐啦？聊了下，才知道她妹妹嫁到新疆了，她爸妈都在那里，她现在带孩子没法上班，已经在乌鲁木齐好多天了。</p>
<p>她说，“新疆现在安保很严，出行得拿好身份证，太晚了就不要在外边活动了，晚上的娱乐项目也没有我们那多，烧烤啥的都找不到。街上的巡逻车，特警，装甲车随处可见，这几天感觉还是松了些。”</p>
<p>“现在除了店里的烧烤，路边几乎找不到咯，摊摊不让摆，这边的形势你们不了解，安全最重要，维稳压倒一切。早市晚市都没有了，买菜也得去专门的菜市场或菜店。在市区玩一天你会发现，过不完的安检门，哈哈…”</p>
<p>她还说早上八点相当于内地的六点，乌鲁木齐和北京有两个小时的时差。那里中午两点才是正午。后来又听导游说，之前新疆用的是新疆时间，现在都必须使用北京时间了。</p>
<p>早上十点左右，我和雪健在人民公园大门口坐上了前往天山的巴士。</p>
<p>我们刚到的时候，还没有太多人，一个小哥在那里接待游客。他见我们走了过去就招呼我们，雪健开口来了句 “How much”，那个小哥一愣，我接着说，“多少钱？” 那小哥才哈哈大笑，我也笑了起来。后来我跟雪健说，“别他把我们当成外国人了啊，哈哈…”</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-9b79a11c272fd977.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="旅游小巴士"></p>
<p>车子出发了，上来位导游，是一位很活跃的女士。一路上，她给我们讲新疆的历史，讲新疆的景点的历史与传说，路上她还用汉语和维吾尔语分别唱了很动听，很富感染力的歌。新疆人能歌善舞，果然不虚啊。导游说当年王洛宾怎样怎样，我就想起了那首歌《在那遥远的地方》，还有三毛曾经因为这首歌而对老先生产出爱意从而 “纠缠不休”，只可惜老先生一直不同意。</p>
<p>后来知道，原来我们的导游是位小学老师，她假期兼职导游，这让我想起了我那同样从事教育的女朋友，想起她曾讲她做导游的经历。</p>
<p>导游讲哈萨克族与白天鹅的不解之缘，哈萨克族自称是白天鹅的后裔。原来有个古老而美丽的传说：“古时，有一年轻的哈萨克族首领在战争中负伤，炎热、疲乏、饥渴使他奄奄一息。这时，一只白天鹅从天而降，用唾液挽救了他的生命，并变身为一个美丽少女与他成婚。为纪念这一奇异的婚配，他们给儿子取名为哈萨克，意为白天鹅”。</p>
<p>天山脚下，有个景区，如果你愿意花点小费，就可以去哈萨克族家中体验一下他们的风俗和生活。那天路过那里，我很想进去体验一下，由于跟团时间紧张原因，未能去看，后来想想，甚为遗憾。</p>
<p>哈萨克，放牧民族，又称瑶池部落。喜喝东方咖啡奶茶。他们信奉伊斯兰教，却是喝酒的民族。在海拔五千多米的地方，他们能歌善舞，每年过着 7 个月的冬天和 5 个月的夏天。在特定的气候下，他们 “早穿皮袄午穿纱，晚上围着火炉吃西瓜”。真是大千世界，不同的地方不同的生活啊。</p>
<p>瑶池民族有三大宝：毡房、牧场、女人身上的珠宝。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-885f77fc0b9d29f5.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="瑶池部落"></p>
<p>天山，海拔 5445 米，除了名字好听，它还是座药山。天山天池盛产雪莲花。天山上长大的羊浑身是宝。吃那里的羊，就相当于吃草药啊。导游说，“为什么外地人总是说其它地方的羊肉没有这里的好吃？因为这里的羊是吃草药长大的啊！”</p>
<p>后来，等我到山顶了，我真去吃了羊肉。烤羊肉，很大的一串只要十元，而且还买五送一。羊肉汤羊杂汤 35 元一碗，肉很多。馕（热腾腾的新疆馕很好吃啊，我尝了不同类型的，都好吃，鉴定完毕）十元一个。羊排十五元一串。吃过之后，至今难忘。我想以后我应该还会再去的吧，单为了吃羊肉应该就会去。那个味，世间少有。回上海后，和同事讨论，一同事说，“味道不一样，是因为那是绵羊”，我觉得有一定道理，但应该不是全部原因。天山那样的地方，总感觉有一种灵气在，它们的山草药，对羊肉的味道也是有影响的。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-44d0df5333914a21.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="天山羊肉"></p>
<p>除了天山，让我感兴趣的还有阿尔泰山和昆仑山。据说阿尔泰山是金山，以前当地人在山上放羊，晚上回来给羊洗脚就可以洗出很多金子来。过去美国西部有淘金热，中国西部也有。导游介绍说，阿尔泰山出产的黄金，曾经还国债（中苏关系恶化，还债苏联）还了近三分之一。我真想去转转啊，万一在山上捡到一块金子呢？</p>
<p>昆仑山则为万山之祖，海拔 6860 米，号称中国第一神山、万祖之山、昆仑丘或玉山。古人称昆仑山为中华 “龙脉之祖”。李白曾写出 “若非群玉山头见，会向瑶台月下逢” 的美诗。相关神话传说有女娲炼石补天、精卫填海、西王母蟠桃盛会、白娘子盗仙草和嫦娥奔月等，此外山海经对昆仑山也有详细的记载。一代伟人毛泽东写有著名词章《念奴娇·昆仑》，其词曰：</p>
<blockquote>
<p>横空出世，莽昆仑，阅尽人间春色。飞起玉龙三百万，搅得周天寒彻。夏日消溶，江河横溢，人或为鱼鳖。千秋功罪，谁人曾与评说？<br>而今我谓昆仑，不要这高，不要这多雪。安得倚天抽宝剑，把汝裁为三截？一截遗欧，一截赠美，一截还东国。太平世界，环球同此凉热。</p>
</blockquote>
<p>可惜我这次来新疆时间太短，只有三天时间，如果时间充裕，我真想去看看阿尔泰山和昆仑山。昆仑山和田玉，像金子一样让我着迷。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-74d178e6e8cbadf8.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="我在天山"></p>
<p>天山上面，天很蓝，阳光很毒辣，雪很白。树下阴森森得冷，阳光下火辣辣得热，晒得皮肤疼，又冻得手脚很凉。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-b3534296aa7d19ce.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="天山天池"></p>
<p>那天，我们绕着天池转了小半圈，用了两三个小时，看着不大的湖，如果要一步步走完的话，估计得一整天。我很想一步步走完，可惜跟团游时间太赶，不然我定要走完的。这也是我为什么不喜欢跟团游的原因。这次来天池之所以选择跟团，是因为没有找到从乌鲁木齐市区到天池的非跟团车。不过话说这次跟团也不错，导游很好，讲解很到位，长了不少知识。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-4f23fa47b122cb23.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="定海神针"></p>
<p>天山上面，唯一的一颗老古榆树，存在不知多少年了。它一直不死，生命力之旺盛，让人钦佩。传说中，天山有个水怪，王母举行蟠桃盛会没有邀请他，他一怒之下开始兴风作怪（怎么有点像孙大圣），王母亦怒，于是她丢下一根神针镇住了水怪。神针落地生根便长成了这棵树。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-bcc8355f86e2b5a8.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="道家仙山"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-67cd1efed390dbc5.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="福寿观"></p>
<p>天山乃道家圣地，王母亦为道家仙人。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-a860343ce23aae49.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="天池"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-f3ebcc0eac676fdb.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="我在瑶池"></p>
<p>身后即是王母娘娘的道场了。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-3c953843e02721ec.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="西王母"></p>
<p>看到她，我心中拜了拜，然后发图给我女友，“感觉她和你有点神似呢”，。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-d7c3a0915d6f656e.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="天山人家"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-a250bf7e6807ec04.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="吃草药的羊儿"></p>
<p><img src="https://upload-images.jianshu.io/upload_images/130752-b910ab25fe41c0f1.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="大荒茫茫"></p>
<p>因为赶时间，在上面待了三四个小时左右就下山了。很不尽兴。如果可以自驾行的话，我得多吃几天的羊肉。从乌鲁木齐到天山，行程大约 120 公里，沿途风景也是很震撼的。茫茫戈壁，寸草不生，荒芜，荒芜，还是荒芜，极度缺水，很少有树木。听说乌市属于北疆，南疆则更艰苦。天山以南，有 “春天你来不来，冬天你走不走” 趣话，清明时节，内地已经春暖花开，而新疆还是穿秋裤，脱秋裤的季节。“呃，冒险如我，有机会得去南疆转转……” </p>
<p>新疆，疆土面积占了我国国土面积近六分之一，人口却只有不足两千一百万，真真是地广人稀了。想想河南省面积那么小，就有一亿多人，没法比哦。</p>
<p>新疆条件艰苦，教育落后，据说只要中专学历就可以考公务员。。。。</p>
<p>下了天山，我出现耳鸣现象，感觉很奇怪，一直觉得只有在飞机上才会耳鸣，天山海拔又不是太高，竟然耳鸣了。在天山脚下，远远望去，一座座小山，光秃秃的，连植被都没有，很有种孤独感。这次跟团，我前面坐着位韩国人，好像名叫谷至信，年龄四五十岁样子，不会说汉语，一个人跑到中国的大腹地，不知当作何感想。</p>
<p>这次时间太匆促，时间多了，我还想去看看沙漠中的胡杨林，还想去转转吐鲁番，还想看看火焰山、葡萄沟。可惜只能寄希望与下次了。</p>
<p>这次时间点不好，听说去新疆的最佳时机是秋天。在那个瓜果成熟一片彩色的季节，那样的新疆才更美。</p>
<p>在新疆的第三天，我和雪健一起逛了逛乌市的农贸市场，每人买了几斤干果葡萄干。后来又去转了转红山公园。</p>
<p>在红山公园看到了林则徐雕像。</p>
<p>这让我想起了那一段历史。当年林则徐虎门销烟后被皇帝贬职到新疆。可是牛人就是牛人，金子在哪里都要发光。林则徐在新疆也是一番作为，深受当地人民热爱。林则徐曾对左宗棠有预言：“东南洋夷，能御之者或有人；西定新疆，舍君莫属”。当后来清室被列强环视欺负时，就保海还是保新疆问题，李鸿章和左宗棠产生了分歧，李主张全力保护沿海地带而舍弃新疆这样的不毛之地，因为国力不足两面兼顾，而左宗棠一派则力主保海保疆都不能放。出征西域，国中无将，于是年老力衰的左宗棠从大局出发，毅然挂帅西征，从而收复伊犁，建树奇功。外交家曾纪泽（曾国藩之子）据理力争，“探虎口索已投之食”，将沙俄已经吃掉的地盘又要了回来，留下佳话美谈。</p>
<p>回程的时候，在飞机上飞了两个小时后，透过窗户向下看，下面还是一片荒芜，茫茫戈壁，寸草不生，不见人家。我就在想，如果把你丢在那里，没有钱，没有车马，让你随便跑，看你跑啊，看你往哪里跑！所以新疆很多监狱。古代对待犯人，有一种刑罚叫作发配边疆，包括现在，新疆也有很多劳改犯。</p>
<p>看着飞机下面茫茫的一片，我又陷入了沉思，胡想了起来：</p>
<blockquote>
<p>我们是谁？我们从哪里来？我们要到哪里去？为什么有时间、空间、动物、植物？如果说宇宙诞生于大爆炸，那么大爆炸之前有什么？</p>
</blockquote>
<p>未知太多啊，几千年容易过，而每个人只有短短几十年寿命，生命太短暂了。</p>
<p>在这有限的生命里，经常出去走一走，看一看，于我，实在是不错的享受。</p>
<p>不同地区，有不同风格的风土人情。山西、陕西有黄土高原，有信天游，有山坡坡上的窑洞热炕； 中原地区有一马平川的开阔；江南有小桥流水的风光旖旎；广东广西那样的大南方则有典型的亚热带、热带气候;号称彩云之南的云南则有不少异域味道。</p>
<p>江南的烟雨、风柳，漠北的草原、戈壁，这个世界，如此奇妙。</p>
<p>我在想，什么时候可以想去哪儿就去哪儿，可以赚钱又没有生存压力该有多好。我理想中的生活，是在大都市有个房子，然后以它为中心满世界的乱跑，读书、写字、周游天下…</p>
<p>总之，这次去新疆，感觉是很不错的。</p>
<p>不到新疆西藏，不知中国之广大。到了新疆，始知这里阳光很好，时间很慢。一位叔叔曾说，新疆是他见过的最美的地方。新疆确实是个好地方，可惜这次我去不了那神奇的沙漠了。</p>
<p>下次吧，下次找个时间多点的时候再去喽。</p>
<pre><code>2018.05.06 15:12
        上海 虹桥
</code></pre>
          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/03/08/2018/读《曾文正公家书全集》/" itemprop="url">
                  读《曾文正公家书全集》
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-03-08T21:21:00+08:00" content="2018-03-08">
              2018-03-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/读书心得/" itemprop="url" rel="index">
                    <span itemprop="name">读书心得</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/03/08/2018/读《曾文正公家书全集》/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/03/08/2018/读《曾文正公家书全集》/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          

          


          
           

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="http://upload-images.jianshu.io/upload_images/130752-8fae2035eb4b3d6c.jpg" alt="图片发自简书App"></p>
<p>前几天读完了《曾文正公家书全集》，现在小结一下，是为记。</p>
<p>《曾文正公家书全集》是晚清一代中兴名臣曾国藩流传最广的作品。该书囊括了曾国藩在道光二十年（1840年）到同治十年（1871年）前后写给祖父母、父母、叔父母、诸弟、妻子及儿辈的家信，所涉内容极其广泛，小到谈家常琐事、做人道理，大到论治学方法、经邦纬国之道，是曾国藩一生思想经历的生动反映，也堪称世人修身、持家、教子的经典读本。</p>
<p>该书由清代李鸿章（李鸿章，很多人只知道他签订了很多丧权辱国的条约，却不知他也是可歌可泣的一代伟人，只不过他生不逢时而已，当时他在西方世界眼中，一人代表了整个中华。梁启超亲自为他立书作传，其人之伟岸，可见一斑）、李瀚章兄弟编撰、校勘，传中书局于光绪年间刊刻。</p>
<p>梁启超在《曾文正公嘉言钞》序内指曾国藩 “岂惟近代，盖有史以来不一二睹之大人也已；岂惟我国，抑全世界不一二睹之大人也已。然而文正固非有超群绝伦之天才，在并时诸贤杰中，称最钝拙；其所遭值事会，亦终生在指逆之中；然乃立德、立功、立言三不朽，所成就震古铄今而莫与京者，其一生得力在立志自拔于流俗，而困而知，而勉而行，历百千艰阻而不挫屈，不求近效，铢积寸累，受之以虚，将之以勤，植之以刚，贞之以恒，帅之以诚，勇猛精进，坚苦卓绝……”</p>
<p>梁启超先生直呼他为：“五千年才出一个的奇人”。</p>
<p>曾国藩不算聪明，却在立德、立功、立言方面均成就不朽，让人羡慕不已，人都说人无完人，如果非要找一个例外出来，或许曾国藩算是一个。就立德方面，他以儒家为宗，每日修身养性，砥砺自律，戒骄慎独；就立功方面，他打败太平天国，为大清挽狂澜于即倒；就立言方面，他著书《曾文正公文集》，流传广泛。后人评价他 “立德立功立言三不朽，为师为将为相一完人”。</p>
<p>小学时，语文老师讲的一个故事让我知道了曾国藩这个人。故事是这样的：</p>
<blockquote>
<p>话说少年时期的曾国藩十分愚笨，一个盛夏的晚上，他书房来了个小偷，正在翻箱倒柜找东西，这时候曾国藩从私塾回来，小偷听见脚步声，赶紧藏到床底下。曾国藩推门进来，开始复习当天学过的内容，其中有一篇文章，虽然不长但是他怎么也背不下来。曾国藩很执著，虽然已经学到了后半夜，但还是没有睡觉的意思，他反复地背那篇文章。这可苦坏了床底下的小偷，他原本想等曾国藩学一会儿睡着后，他出来再拿一点东西，然后就走。但是，听曾国藩读文章的劲头，好像这晚不睡了。炎热的夏天，他在床底下苦不堪言。小偷耐着性子，听曾国藩又读那篇文章很多遍还是背不下来，最后实在控制不住自己，他从床底下爬出来，来到曾国藩面前，拿过曾国藩手中的书摔在地上，吼道：“就你这么笨，还读什么书！我在床底下听都听会了。” 说完很流利地把曾国藩背了大半夜还没有背下来的文章，一字不差地背下来，然后扬长而去。曾国藩直直地看着小偷，羞愧难当。可是自此以后，他却更加发奋，终于勤能补拙，后来成就了他的伟业。</p>
</blockquote>
<p>故事不知真假，却说明一个道理，勤能补拙是良训！</p>
<p>在曾国藩家书中，他多次向其诸弟强调勤俭的作用。他说 “无论治世乱世，凡一家之中，能勤能敬，未有不兴者。不勤不敬，未有不败者”。对我而言，“勤、敬” 是我从书中学到的最重要的两个字。我的梦想是再兴我的家族，勤敬二字，或许可以作为我家传家之宝。</p>
<p>中学历史课上，老师又讲了曾国藩的故事，故事很精彩，是有关曾国藩和太平天国打仗的故事，我又进一步认识了曾国藩：</p>
<blockquote>
<p>清咸丰四年(公元1854年)4月2日，曾国藩亲率湘军水师在长沙靖港与太平军作战，这也是 44 岁的曾国藩和 24 岁的石达开第一次交手。这场战役，被认为是石达开 “最辉煌” 的一次。湘军一触即溃，曾国藩且羞且惧，跳入湘江，欲寻死。出征前，他已写好 “舍生取义” 的遗书，这一举动，恰好被他的两位幕客李元度与陈士杰发现，两人找来另一位幕客章寿麟(民国名士章士钊族兄)，嘱托他躲在曾国藩座船的后舱，保证曾国藩的安全。于是，当曾国藩投江后，章寿麟赶紧入水施救。为改变曾国藩心意，他还扯谎说，湘军在湘潭大胜，先锋部队正赶往靖港。曾国藩一听有救，便上了船。上岸后，曾国藩才知道自己被骗，决意再次赴死。他又写遗书，将死期延至4月4日——死前还要办理军务交接，得留足时间。巧的是，就在4月3日夜，湘潭传来捷报，湘军大胜，不日回援长沙。曾国藩最终免于一死。</p>
</blockquote>
<p>现在读完曾氏家书，闭上眼，我仿佛能看到其人（曾国藩）。</p>
<p>以前总是对清朝没有好感，一提起清朝，就让人想到 “愚昧、闭关锁国、落后”，可是现在倒觉得清人有很多是很厉害的，像《红楼梦》成就小说前无古人后无来者的艺术高峰，它就是由清人写的。近来读曾国藩，更加觉得那个时代的人的厉害。</p>
<p>毛泽东曾说，“愚于近人，独服曾文正，观其收拾洪杨一役，完满无缺”，即使在他晚年，他也说：“曾国藩是地主阶级最厉害的人物”。</p>
<p>蒋中正对曾国藩更是顶礼膜拜，认为曾国藩为人之道，“足为吾人之师资”，“其著作为任何政治家所必读”。</p>
<p>没读曾书前，总觉得那个时代（清末）的人迂腐、无知，读了曾书，反倒觉得现在的自己无知、愚昧了。</p>
<p>书中有很多关于为学、处世、修身养性、教育等方面的知识。</p>
<p>就为学方面，曾国藩在他的书信中经常不厌其烦地教育他的诸弟，效果非常显著，后来他的兄弟中，有多位身居高位，政绩更是不错。像曾国藩家庭这样有用人才之多，分布行业之广，影响之大，在中国历史上是罕见的。这和好的教育不无关系。</p>
<p>曾国藩的几个有作为的兄弟：</p>
<p>曾国藩四弟：曾国潢，原名国英，字澄侯，曾麟书（曾国藩父亲）次子，族中排行第四，因此被曾国藩称为四弟，曾氏兄弟间皆以族中排行相称。曾任通议大夫建威将军。</p>
<p>曾国藩六弟：曾国华，字温甫，曾麟书第三子，族中排行第六。镇压太平天国时战死于三河镇。</p>
<p>曾国藩九弟：曾国荃，字沅甫，曾麟书第四子，族中排行第九，人称“曾老九”。镇压太平天国的用力之将，官至两江总督。在与太平军作战中，是其兄国藩的重要助手，因其善于围城，又精于长壕法，人称曾铁桶。</p>
<p>曾氏兄弟 “扎硬寨，打呆仗” 的作战方法，不但在行军打仗中可行，即使在现在的商场以及其它很多事情中，都有可行之处。据说逻辑思维的得到公司的墙上就粘贴着这几个字，以此作为其公司的战略方针。</p>
<p>曾国藩除了有厉害的兄弟，他的儿子们也非常出众：</p>
<p>曾纪泽，字劼刚，号梦瞻，是中国清代著名外交家，亦是清朝中兴名臣。袭封一等毅勇侯。曾任清政府驻英、法、俄国大使，也是当时秉承 “经世致用” 新思维的知识分子。</p>
<p>曾纪鸿，字粟诚，曾国藩次子，数学家。 曾纪鸿嗜好数学，同治十三年, 在湖南荷叶作《圆率考真图解》一书，曾计算出100位的圆周率。</p>
<p>有人曾经统计的资料显示，自曾国藩始，在其后的一百多年时间里，他的子孙中有成就的人多达240多位：</p>
<p>他们在化学界、教育界、文学界、艺术界、考古界、交通界等多个领域都取得了不凡的成就。像教育家曾约农、曾宝荪；翻译家曾宝葹；高教部副部长、化学家曾昭抡；考古学家、博物馆学家曾昭燏；北平交通博物馆主任曾昭亿；原农业部办公厅主任、园艺学家曾宪朴；全国妇联副主席曾宪植；3位中国人民大学教授曾宪楷、曾宪柱、曾宪森；画家曾厚熙、导演曾宪涤等等。</p>
<p>一个家族之中，人才辈出如此，真的让人羡慕不已。曾国藩曾说，“兄弟和，虽穷氓小户必兴；兄弟不和，虽世家宦族必败。” 这足以让所有有家族兄弟的人好好学习。</p>
<p>曾国藩还说，“吾家子侄，人人须以勤俭二字自勉，庶几长保盛美。观《汉书·霍光传》，而知家所以速败之故。观金日磾、张安世二传，解示后辈可也。”</p>
<blockquote>
<p>注：张安世: 张汤之子,麒麟阁十一功臣之一，汉武帝时为尚书令，迁光禄大夫。汉昭帝时，拜右将军兼光禄勋，以辅佐功封富平侯。汉宣帝时，累官至大司马卫将军、领尚书事，集军政大权于一身，以为官廉洁著称。</p>
</blockquote>
<p>以前读张汤（张安世之父），读到其子孙成就 “三朝重臣，九世封候” ，张家富贵数百年，绵延有汉一朝。让我不禁唏嘘感叹，九世是什么概念！人和人差距竟有如是欤！我是很传统的，不期能受惠于先，却望可恩泽于后。我想，我宗一门再兴，或将自我始。</p>
<p>如果想要教育好，肯定要多读书，要勤学习，曾国藩就为学方面，无论要求自己还是要求家人，都非常严格。书中有如下记载:</p>
<p><em>什么时候读书都不晚：</em></p>
<blockquote>
<p>昔婺源汪双池先生，一贫如洗，三十以前在窑上为人佣工画碗，三十以后，读书训蒙，到老终身不应科举，卒著书百余卷，为本朝有数名儒。彼何尝有师友哉？又何尝出里闾哉？</p>
</blockquote>
<p>私认为，什么时候读书都不晚，什么时候学习都不完，只要还活着，就要活到老学到老，活着就是一个不断认知的过程。</p>
<p><em>什么地方都可以读书：</em></p>
<blockquote>
<p>且苟能发奋自立，则家塾可读书，即旷野之地，热闹之场，亦可读书，负薪牧豕，皆可读书；苟不能发奋自立，则家塾不益读书，即清净之乡，神仙之境，皆不能读书，何必择地？但自问立志之真不真耳！</p>
</blockquote>
<p><em>读书之道:</em></p>
<blockquote>
<p>于读书之道，有必不可易者数端：穷经必专一经，不可泛骛。读经以研寻义理为本，考据名物为末。读经有一“耐”字诀：一句不通，不看下句；今日不通，明日再读；今年不精，明年再读，此所谓耐也。读史之法，莫妙于设身处地。每看一处，如我便与当时之人酬醉笑语于其间。不必人人皆能记也，但记一人，则恍如接其人；不必事事皆能记也，但记一事，则恍如亲其事。经以穷理，史以考事，舍此二者，更别无学矣。</p>
<p>盖自西汉以至于今，识字之儒约有三途：曰义理之学，曰考据之学，曰词章之学，各执一途，互相诋毁。兄之私意，以为义理之学最大。义理明，则躬行有要，而经济有本；词章之学，亦所以发挥义理者也；考据之学，吾无取焉矣。此三途者，皆从事经史，各有门径。吾以为欲读经史，但当研究义理，则心一而不纷。是故经则专守一经，史则专熟一代，读经史则专主义理。此皆守约之道，确乎不可易者也。</p>
<p>读经，读史，读专集，讲义理之学，此有志者万不可易者也。圣人复起，必从吾言矣。然此亦仅为有大志者言之。若夫为科名之学，则要读四书文，读试律赋，头绪甚多。四弟、九弟、厚二弟天质较低，必须为科名之学。六弟既有大志，虽不科名可也，但当守一“耐”字诀耳。观来信言读《礼记疏》，似不能耐者，勉之勉之！</p>
<p>若夫经史而外，诸子百家，汗牛充栋。或欲阅之，但当读一人之专集，不当东翻西阅。如读《昌黎集》，则目之所见，耳之所闻，无非昌黎，以为天地间除《昌黎集》而外，更别无书也。此一集未读完，断断不换他集，亦“专”字诀也。六弟谨记之。</p>
</blockquote>
<p>注：读书，“一集未读完，断断不换他集”，这个我做不到！我习惯同时读两三本书。</p>
<p><em>读书需要有倔强精神：</em></p>
<blockquote>
<p>至于倔强二字，却不可少。功业文章，皆须有此二字贯注其中，否则柔靡不能成一事。孟子所谓至刚，孔子所谓贞固，皆从倔强二字做出。吾兄弟皆禀母德居多，其好处亦正在倔强。若能去忿欲以养体，存倔强以励志，则日进无疆矣。</p>
</blockquote>
<p><em>读书要有志：</em></p>
<blockquote>
<p>自古圣贤豪杰，文人才士，其志事不同，而其豁达光明之胸大略相同。以诗言之，必先有豁达光明之识，而后有冲淡冲融之趣。如李白、韩退之、杜牧之则豁达处多，陶渊明、孟浩然、白香山则冲淡处多，杜、苏二公无美不备，而杜之五律最冲淡，苏之七古最豁达。邵尧夫虽非诗之正宗，而豁达、冲淡二者兼全。看好读《庄子》、以其豁达足益人胸燃也。去年所讲“生而美者，若知之，若不知之，若闻之，若不闻之”一段，最为豁达。推之即“舜、禹之有天下而不与”，亦同此襟怀也。</p>
</blockquote>
<p><em>读书目的：</em></p>
<blockquote>
<p>吾辈读书只有两事，一者进德之事，讲求乎诚正修齐之道，以求无忝余生；一者修业之事，操习乎记诵词章之术，以求自卫其身。</p>
</blockquote>
<p><em>读书要精：</em></p>
<blockquote>
<p>求业之精，别无他法，曰专而已矣！谚曰“艺多不养身”，谓不专也。</p>
</blockquote>
<p><em>读书方法：</em></p>
<blockquote>
<p>朱子言，“为学譬如熬肉，必须猛火煮，然后用漫火温”。</p>
<p>盖士人读书，第一要有志，第二要有识，第三要有恒。有志，则断不甘为下流；有识，则知学问无尽，不敢以一得自足，如河伯之观海，如井蛙之窥天，皆无识也；有恒，则断无不成之事。此三者缺一不可。</p>
</blockquote>
<p>曾国藩给自己的课程表是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">主敬：整齐严肃，清明在躬，如日之升。</span><br><span class="line">静坐：每日不拘何时，静坐四刻，正位凝命，如鼎之镇。</span><br><span class="line">早起：黎明即起，醒后勿沾恋。</span><br><span class="line">读书不二：一书未完，不看他书。</span><br><span class="line">读史：念三史（指《史记》、《汉书》、《后汉书》），每日圈点十页，虽有事不间断。</span><br><span class="line">谨言：刻刻留心，第一工夫。</span><br><span class="line">养气：气藏丹田，无不可对人言之事。</span><br><span class="line">保身：节劳、节欲、节饮食。</span><br><span class="line">日知其所无：每日读书，记录心得语。</span><br><span class="line">月无忘其所能：每月作诗文数首，以验积理的多寡，养气之盛否。</span><br><span class="line">作字：饭后写字半时。</span><br><span class="line">夜不出门。</span><br></pre></td></tr></table></figure>
<p>诸君看后有何感想？</p>
<p>曾国藩少年时候家中很穷，那个时候他家里还要靠借债过日子，可是到后来，他们曾家一门一下子出了好几位高官，可谓达到人臣极盛。面对如此情景，曾国藩却处处小心，因为他知道 “日中则昃，月盈则亏” 的道理。</p>
<p>他常教育自己的兄弟们，要谨慎，要畏天命，他说：</p>
<blockquote>
<p>平日最好昔人 “花未全开月未圆” 七字，以为惜福之道、保泰之法莫精于此。</p>
<p> 盖天下之理，满则招损，亢则有悔，日中则昃，月盈则亏，至当不易之理也。</p>
</blockquote>
<p>润文注：戒之！戒之！希望我的事业学业永远达不到最高点。</p>
<blockquote>
<p> 极盛则有盈满之惧，亦可畏也。</p>
<p>不贪财，不失信，不自是，有此三者，自然鬼服神钦，到处人皆敬重。</p>
<p>天下古今之庸人，皆以一惰字致败；天下古今之才人，皆以一傲字致败。</p>
<p>大约军事之败，非傲即惰，二者必居其一；巨室之败，非傲即惰，二者必居其一。</p>
<p>凡办大事，以识为主，以才为辅；凡成大事，人谋居半，天意居半。</p>
</blockquote>
<p>他行事处处小心谨慎，或许显得有点过了，但是他的做法却值得我们学习。</p>
<p>“天道轮回，苍天绕过谁！” 无论你信不信，天命诚可畏！做人要低调啊！低调做人，高调做事。</p>
<p>一个官员想要在官场得意，一个家族想要经久不衰，曾国藩的做法是很值得借鉴的。</p>
<p>一个人太锋芒毕露了，早晚要吃亏，就像刀锋太锋利了，易折，一如霍去病，年纪轻轻便成就不世之功，奈何终拗不过天命，二十三岁便英年早逝。痛哉！惜哉！</p>
<p>一个家族若想兴盛经久不衰，肯定要有它的家规、家训。那是一个家族的文化财富，那是流淌在一个家族所有成员血液中的灵魂。</p>
<p>曾家家训大抵是这样的：</p>
<blockquote>
<p>予与沅弟论治家之道，一切以星冈公（曾国藩祖父）为法，大约有八字诀。其四字即上年所称 “书、蔬、鱼、猪”也；又四字则曰“早、扫、考、宝”。早者，起早也；扫者，扫屋也；考者，祖先祭祀，敬奉显考、王考、曾祖考，言考而妣可该也；宝者亲族邻里，时时周旋，贺喜吊丧，问疾济急，星冈公常曰：“人待人，无价之宝也。” 星冈公生平于此数端最为认真，故余戏述为八字诀曰 “书、蔬、鱼、猪、早、扫、考、宝” 也。</p>
</blockquote>
<p>其中，“书” 当然是要读书啦。我倒认为，即使不能家族异常兴盛，小户人家也要做个书香门第。</p>
<p>曾国藩说，“家中种蔬，屋门首堂养鱼，养猪亦内政之要者，下首台上新竹。此四者，可以觇人家兴衰气象。”</p>
<p>除了为学还要注重养生。曾国藩说，“吾见家中后辈，体皆虚弱，读书不甚长进，曾以养生六事勖儿辈：一曰饭后千步，一曰将睡洗脚，一曰胸无恼怒，一曰静坐有常时，一曰习射有常时，一曰黎明吃白饭一碗，不沾点菜。此皆闻诸老人，累试毫无流弊者，今亦望家中诸侄试行之。” 又说，“养生与为学，二者兼营并进，则志强而身不弱，或是家中振兴之象。”</p>
<p>一本厚厚的《曾文正公家书全集》大部头，读完它花费了我不少的夜间时间，也废了我不少的精力，好在读完它让我有不小的成就感。曾文正的读书为学方法以及他教育子弟的思想，多多少少会对我今后的言行有所影响，也许这是这本书对我的最大价值吧。</p>
<p>读史可以使人明智，鉴以往可以知未来。历史不会重演，但历史却惊人的相似。</p>
<p>2018.03.08  21:21<br>上海 新泾北苑</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/02/05/2018/iOS ViewController 瘦身实践/" itemprop="url">
                  iOS ViewController 瘦身实践
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-02-05T00:00:00+08:00" content="2018-02-05">
              2018-02-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/iOS-开发/" itemprop="url" rel="index">
                    <span itemprop="name">iOS 开发</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/02/05/2018/iOS ViewController 瘦身实践/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/02/05/2018/iOS ViewController 瘦身实践/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          

          


          
           

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当我们每次重复性的在含有 tableView  的 ViewController 里面写 table view delegate 和 dataSource方法时，我们是否感到厌烦呢？出于尽量不做重复的事情的目的，我们是否可以把 tableView 代理方法抽取出一个公共类呢？答案当然是肯定的。</p>
<p>在沐风影音项目中，我将 table view dataSource 方法抽取出来，使用 ArrayDataSource 类进行统一管理。当一个  table view 中展示的是一个个对象，我们都可以使用这种方式。这样开始费一点时间，后来会节省很多时间，所谓磨刀不误砍柴工是也。</p>
<p>核心代码如下：</p>
<h5 id="1-公共类-ArrayDataSource"><a href="#1-公共类-ArrayDataSource" class="headerlink" title="1. 公共类 ArrayDataSource"></a>1. 公共类 ArrayDataSource</h5><p>ArrayDataSource.h</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">typedef void (^TableViewCellConfigureBlock)(id cell, id item);</span><br><span class="line"></span><br><span class="line">@interface ArrayDataSource : NSObject&lt;UITableViewDataSource&gt;</span><br><span class="line"></span><br><span class="line">- (id)initWithItems:(NSArray *)anItems</span><br><span class="line">     cellIdentifier:(NSString *)aCellIdentifier</span><br><span class="line"> configureCellBlock:(TableViewCellConfigureBlock)aConfigureCellBlock;</span><br><span class="line"></span><br><span class="line">- (id)itemAtIndexPath:(NSIndexPath *)indexPath;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>ArrayDataSource.m</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;ArrayDataSource.h&quot;</span><br><span class="line"></span><br><span class="line">@interface ArrayDataSource ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) NSArray *items;</span><br><span class="line">@property (nonatomic, copy) NSString *cellIdentifier;</span><br><span class="line">@property (nonatomic, copy) TableViewCellConfigureBlock configureCellBlock;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation ArrayDataSource</span><br><span class="line"></span><br><span class="line">- (id)init</span><br><span class="line">&#123;</span><br><span class="line">    return nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (id)initWithItems:(NSArray *)anItems</span><br><span class="line">     cellIdentifier:(NSString *)aCellIdentifier</span><br><span class="line"> configureCellBlock:(TableViewCellConfigureBlock)aConfigureCellBlock</span><br><span class="line">&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        self.items = anItems;</span><br><span class="line">        self.cellIdentifier = aCellIdentifier;</span><br><span class="line">        self.configureCellBlock = [aConfigureCellBlock copy];// 在初始化 cell 的时候赋值 configureCellBlock </span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (id)itemAtIndexPath:(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    return self.items[(NSUInteger) indexPath.row];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#pragma mark UITableViewDataSource</span><br><span class="line"></span><br><span class="line">- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section</span><br><span class="line">&#123;</span><br><span class="line">    return self.items.count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:self.cellIdentifier</span><br><span class="line">                                                            forIndexPath:indexPath];</span><br><span class="line">    id item = [self itemAtIndexPath:indexPath];</span><br><span class="line">    self.configureCellBlock(cell, item);// 这里执行block方法，为cell元素赋值</span><br><span class="line">    return cell;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h5 id="沐风影音中使用的对象-MFFolder，当然你可以根据自己需要定义不同的模型，之后只要将-model-类传递给cell-就好了。"><a href="#沐风影音中使用的对象-MFFolder，当然你可以根据自己需要定义不同的模型，之后只要将-model-类传递给cell-就好了。" class="headerlink" title="沐风影音中使用的对象 MFFolder，当然你可以根据自己需要定义不同的模型，之后只要将 model 类传递给cell 就好了。"></a>沐风影音中使用的对象 MFFolder，当然你可以根据自己需要定义不同的模型，之后只要将 model 类传递给cell 就好了。</h5><p>模型类 MFFolder.h</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">@interface MFFolder : NSObject</span><br><span class="line"></span><br><span class="line">@property(nonatomic,strong) NSString *name;// 文件夹名称</span><br><span class="line">@property(nonatomic,strong) NSString *imgName;// 缩略图名称</span><br><span class="line">@property(nonatomic,strong) NSArray * subItems;// 子对象</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>自定义cell MFFolderTableViewCell.h</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;UIKit/UIKit.h&gt;</span><br><span class="line"></span><br><span class="line">@class MFFolder;</span><br><span class="line"></span><br><span class="line">@interface MFFolderTableViewCell : UITableViewCell</span><br><span class="line"></span><br><span class="line">@property (weak, nonatomic) IBOutlet UIImageView *imgVIew;</span><br><span class="line">@property (weak, nonatomic) IBOutlet UILabel *nameLbl;</span><br><span class="line"></span><br><span class="line">// 根据 MFFolder 配置 cell 内容</span><br><span class="line">- (void)configureForFolder:(MFFolder *)folder;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>MFFolderTableViewCell.m</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;MFFolderTableViewCell.h&quot;</span><br><span class="line">#import &quot;MFFolder.h&quot;</span><br><span class="line"></span><br><span class="line">@implementation MFFolderTableViewCell</span><br><span class="line"></span><br><span class="line">- (void)awakeFromNib &#123;</span><br><span class="line">    [super awakeFromNib];</span><br><span class="line">    // Initialization code</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)setSelected:(BOOL)selected animated:(BOOL)animated &#123;</span><br><span class="line">    [super setSelected:selected animated:animated];</span><br><span class="line"></span><br><span class="line">    // Configure the view for the selected state</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">-(id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier&#123;</span><br><span class="line">    self = [super initWithStyle: style reuseIdentifier:reuseIdentifier];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        NSArray *nibArray = [[NSBundle mainBundle]loadNibNamed:@&quot;MFFolderTableViewCell&quot; owner:nil options:nil];</span><br><span class="line">        self = [nibArray lastObject];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;*/</span><br><span class="line"></span><br><span class="line">- (void)configureForFolder:(MFFolder *)folder</span><br><span class="line">&#123;</span><br><span class="line">    self.imgVIew.image = [UIImage imageNamed:folder.imgName];</span><br><span class="line">    self.nameLbl.text = folder.name;</span><br><span class="line">    </span><br><span class="line">    self.nameLbl.numberOfLines = 0;</span><br><span class="line">    self.nameLbl.minimumScaleFactor = 0.6;</span><br><span class="line">    self.nameLbl.adjustsFontSizeToFitWidth = YES;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h5 id="3-viewController-移动文件页面，一个viewController示例"><a href="#3-viewController-移动文件页面，一个viewController示例" class="headerlink" title="3. viewController 移动文件页面，一个viewController示例"></a>3. viewController 移动文件页面，一个viewController示例</h5><p>MFFolderViewController.m<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">#import &quot;MFFolderViewController.h&quot;</span><br><span class="line">#import &quot;ArrayDataSource.h&quot;</span><br><span class="line">#import &quot;MFFolder.h&quot;</span><br><span class="line">#import &quot;MFFolderTableViewCell.h&quot;</span><br><span class="line">#import &quot;MFFileManager.h&quot;</span><br><span class="line">#import &quot;MFFileTypeJudgmentUtil.h&quot;</span><br><span class="line"></span><br><span class="line">static NSString * const FolderCellIdentifier = @&quot;FolderCell&quot;;</span><br><span class="line"></span><br><span class="line">@interface MFFolderViewController ()</span><br><span class="line"></span><br><span class="line">@property (weak, nonatomic) IBOutlet UITableView *myTableView;</span><br><span class="line">@property (nonatomic, strong) ArrayDataSource * foldersArrayDataSource;</span><br><span class="line">@property (nonatomic, strong) NSMutableArray *folders;// 当前页面含有的文件夹数组</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation MFFolderViewController</span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    self.title = @&quot;移动文件&quot;;</span><br><span class="line">   </span><br><span class="line">    // 初始化数据源</span><br><span class="line">    [self loadDataArray];</span><br><span class="line">    // 设置tableView</span><br><span class="line">    [self setupTableView];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)didReceiveMemoryWarning &#123;</span><br><span class="line">    [super didReceiveMemoryWarning];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置tableView</span><br><span class="line">- (void)setupTableView</span><br><span class="line">&#123;</span><br><span class="line">    TableViewCellConfigureBlock configureCell = ^(MFFolderTableViewCell *cell, MFFolder *folder) &#123;</span><br><span class="line">        [cell configureForFolder:folder];</span><br><span class="line">    &#125;;// 这里初始化 cellConfigureBlock </span><br><span class="line">    NSArray *items = [self.folders copy];</span><br><span class="line">    </span><br><span class="line">    // 对比指针地址</span><br><span class="line">    NSLog(@&quot;items== %p&quot;,items);</span><br><span class="line">    NSLog(@&quot;self.folders== %p&quot;,self.folders);</span><br><span class="line">    </span><br><span class="line">    self.foldersArrayDataSource = [[ArrayDataSource alloc] initWithItems:items</span><br><span class="line">                                                         cellIdentifier:FolderCellIdentifier</span><br><span class="line">                                                     configureCellBlock:configureCell];</span><br><span class="line">    self.myTableView.dataSource = self.foldersArrayDataSource;</span><br><span class="line">    // 如果使用 registerClass，需要在cell的实现文件中重写initWithStyle并加载自己的nib</span><br><span class="line">    // [self.myTableView registerClass:[MFFolderTableViewCell class] forCellReuseIdentifier:FolderCellIdentifier];</span><br><span class="line">    [self.myTableView registerNib:[UINib nibWithNibName:@&quot;MFFolderTableViewCell&quot; bundle:nil] forCellReuseIdentifier:FolderCellIdentifier];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark UITableViewDelegate</span><br><span class="line"></span><br><span class="line">- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#pragma mark - Custom Methods</span><br><span class="line">#pragma mark - 加载数据源</span><br><span class="line">-(void)loadDataArray &#123;</span><br><span class="line">    NSMutableArray * filesArr = [MFFileManager readDownloadedFiles:@&quot;&quot;];</span><br><span class="line">    self.folders = [[NSMutableArray alloc] init];</span><br><span class="line">    </span><br><span class="line">    for (NSString *name in filesArr) &#123;</span><br><span class="line">        if ([MFFileTypeJudgmentUtil isFolderType:name]) &#123;// 判断是否是文件夹</span><br><span class="line">        </span><br><span class="line">            MFFolder *folder = [[MFFolder alloc] init];</span><br><span class="line">            folder.name = name;</span><br><span class="line">            folder.imgName = @&quot;cellThumbnailFolder&quot;;</span><br><span class="line">        </span><br><span class="line">            [self.folders addObject:folder];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></p>
<p>至此，一个简单的 tableView 瘦身示例完毕。</p>
<p>2018.02.05<br>上海 虹桥</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/01/06/2018/我的2017年/" itemprop="url">
                  我的2017年
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2018-01-06T19:36:00+08:00" content="2018-01-06">
              2018-01-06
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/我的随笔/" itemprop="url" rel="index">
                    <span itemprop="name">我的随笔</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2018/01/06/2018/我的2017年/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/01/06/2018/我的2017年/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          

          


          
           

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>时间过得太快，这就 2018 年了，记得 2017 年一月里写文件签日期的时候，总会潜意识里签成 2016，包括续签合同都是这样，去年一月时候，仿佛还在昨天，倏忽间，现在 2017 年也过完了。不能不感慨 How time flies！</p>
<p>回顾自己的 2017，有得有失，如果自己给自己打分的话，满分 10分，我给自己 7.5，还算马马虎虎吧，但是让人不满意，我应该可以做得更好的。</p>
<p>回顾自己走的路，对好的方面，对不满意的地方，对可以改进的地方，自己都应该有个总结和反思，以求以后可以摒弃坏毛病发扬好习惯，不断的迭代更新自己，使自己变得越来越好。</p>
<p>去年年初定的一些目标，今年完成情况如下:</p>
<p>关于跑步，全年累计跑了 600 公里，算是完成了目标。这个效果不错，必须得瑟一下。除了去年夏天最热的时候，平均每周至少有两三次长跑。跑步带给人的益处真是太多了，它可以排除人内心的焦虑和不健康情绪，跑步的过程也是禅修和学习的过程。我会用跑步那段时间听得到专栏或者听书，如果听到自己喜欢的内容，会是个很享受的过程。跑步开始会很艰难，坚持会更艰难，起初开始跑的时候，会很不舒服，毕竟是个体力活，可是一旦你习惯了，等跑完一段历程，你会觉得走路都变轻了，你会更有力气，那种感觉让人愉悦。总的来说，跑步可以使人身体和精神都得到提升。今年，我希望可以跑完 1000 公里。</p>
<p>关于听得到专栏，去年一年，很有幸听到了吴军专栏。他的第一季硅谷来信，我已经一集不拉全部听完，除此之外还读了他的三本书–《数学之美》、《大学之路》、《浪潮之巅》，感觉受益匪浅。吴军博士的很多观念很合我的胃口，真有相见恨晚的感觉。听完一年他的专栏，我想我是有改变的，吴军教会我要会工作，会学习，会生活，还有见识和视野很重要。不能不说，很多知识和技能，学习起来是有技巧的，工作方面的事情，如果想要做好也是有策略的。无论从事哪个行业，想最快的进步，最好的方法应该是找行业内的顶级专家，然后向他们学习，向他们看齐。吴军作为计算机博士，告诫我们在工程中要注意道和术的区别。在技术圈里混，做事情的道尤为重要。此外，他还让我明白，写作不一定非要有华丽的辞藻才行，好的作品要有内容。以理科生的思维行事，避免过分感性带来的恶果。</p>
<p>关于做规划和具体实施。我现在使用 OKR进行自我管理。我将年任务分解到季度，每个季度尽力去实现自己的目标。我的 OKR 写在印象笔记里面，然后给它设置个快捷方式，每天使用印象笔记的时候，都会去快捷方式里面看一看，如果完成了一个小任务，就划勾，争取季度季度结束时，任务全被我划掉。划掉任务的感觉是很好的。我的 OKR 大类分为：读书计划，技术学习计划，兴趣计划。每个计划下面列出将要完成的一个个小目标。</p>
<p>我是印象笔记付费用户，已经用了三年了。现在真的已经离不开它了。在印象笔记中，我分类了几大类笔记本，技术的和人文的分开，相同类型的笔记打同一个 tag，通过分类和标签快速找到自己需要的素材。现在，无论在电脑上还是手机上，一旦遇到自己喜欢的素材，我都会将它们保存到我的印象笔记中。还有读书笔记，还有自己写的日记（包括手写的），我都会找时间集中把它们备份到印象笔记，这样就再也不用担心数据会丢失了。想起好多年前写的文字，好多现在都再也找不到了，感觉真可惜。保存到印象笔记，这样的情况再也不会发生。多年后，印象笔记里的素材库将是个人最好的知识体系。</p>
<p>此外，我还坚持写晨间日记。工作日的每天早上我会花费十几分钟到半小时，从几个方面写昨天的事情回顾以及总结教训。晨间日记已经写了一年半了，由起初的总是忘记写，到现在已经成为一种习惯了。如果那个工作日不写，反倒会感觉少了些什么。</p>
<p>写完晨间日记，然后开始部署今天的 todo list ，我现在使用Things 软件进行任务管理。想好今天要办的事情，将它们定成任务写进今日待办事项，然后集中精力去完成它们。做事情的时候，如果总是分神，注意力不够集中，我会用番茄工作法使用软件进行时间管理。在番茄钟内，要一直专注，最忌一个番茄钟（25分钟，或者自定义的其它时长）中途注意力被打断。做一件事情，既然花时间和精力了，就应该尽自己最大能力去把它做好，做到自己可以做的最好。</p>
<p>关于技术，这一年，技术书读的偏少了。因为工作上技术方向被切换的原因，由原来的 iOS 转到了 Java，学了一些新知识，多了一些技能，跳出了技术舒适区，但这样又有了新问题，技术可以多，但一定要有个特别突出特别精的才好。技术岗位无论被怎么变，自己不能失了方向。过去的一年，业余时间搞了一个 app，想上线 app store，未能如期实现。这其中有很多原因，但是没有成功就是没有成功，一定要总结教训。好在开发进行了七八成，再加把劲儿就好了。期望以后自己可以做出真正属于自己的出色的产品来。</p>
<p>关于兴趣爱好，这一年入门了 PS 和摄影，这个付出了很多时间和精力，好在有所收获。修图，摄影，这样的艺术情怀，看似和技术无关，其实关系很大了，有好的审美，好的设计，做出的产品才能卓尔不群，甚至伟大。</p>
<p>关于旅行，2017 年主要去了黄山、安吉、洛阳、杭州、苏州、香港、重庆，还算可以吧，希望 2018 可以再多去几个喜欢的地方。最好能够到达拉萨。</p>
<p>关于英语学习，去年读了几本全英文书籍，现在阅读应该还算可以了，但是听说能力实在太差。好在年底发现了一个不错的学习软件，在上面训练自己的听说能力，用了两个月，效果还好。以后继续练习英语听说，希望明年此时可以达到能和老外流利沟通的水平。以后想法赚到老外的钱才好。</p>
<p>关于人际关系，发现自己的情商不够，生活中很多事情做得不到位，与多人关系比较尴尬，如果和一人两人关系那样，可能是别人的错，可是如果和很多人都是那样，那就是自己的问题了。以后多读些非技术类的书籍，多学点为人处事之道，希望可以有所改善吧。就像一位朋友说的那样，这块儿可以要求自己不必达到优秀的水平，但是要达到六十分及格。</p>
<p>关于意外，去年做了两次手术，流了很多血，一次是因为切菜时一个分神切掉了左手食指一小块儿肉，那一刻，鲜血直涌，堵都堵不住，十指连心，那个痛啊！一次是做了个腱鞘囊肿切除手术。手术是在骨头边刮肉，虽然打了麻药，可是还是感觉十分明显，至今回想，仍心有余悸。好在一切都过去了。希望自己以后的余生都可以健健康康的。健康是革命的本钱。</p>
<p>时间过得太快，有时会让人有所恐慌。想想一辈子会很快走完，又不免很是忧伤。不过没办法改变的事情，自己就应该学会适应。通过努力，希望可以活出自己的精彩吧。2018年，继续加油，再努力一点，再拼搏一点，希望来年此时可以交出更好的成绩。</p>
<p>2018.01.06 19:36<br>上海 新泾北苑</p>
<p>附：</p>
<blockquote>
<p>Google目标管理方法OKR(Objects Key Results)<br>每个季度都需要给自己定一个或者几个目标（Objects）,以及衡量目标是否达成的关键结果（Key Results）。<br>季度结束时，每个人都会给自己的目标完成情况打分。完成了，得分是1。部分完成，得分是0到1之间的数字。<br>目标要有挑战性，得分总是1，并不能说明工作好，而是目标定得太低。<br>总结季度工作时，可以增加当初没有制定的目标，对于不打算完成的目标，或者已经过时、不再有意义的目标，不能删除，但是可以说明为什么没有做。</p>
</blockquote>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/12/07/2017/Core-Text-Tutorial-for-iOS--Making-a-Magazine-App-翻译/" itemprop="url">
                  Core-Text-Tutorial-for-iOS--Making-a-Magazine-App-翻译
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-12-07T00:00:00+08:00" content="2017-12-07">
              2017-12-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术博客翻译/" itemprop="url" rel="index">
                    <span itemprop="name">技术博客翻译</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/12/07/2017/Core-Text-Tutorial-for-iOS--Making-a-Magazine-App-翻译/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/12/07/2017/Core-Text-Tutorial-for-iOS--Making-a-Magazine-App-翻译/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          

          


          
           

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文：<a href="https://www.raywenderlich.com/153591/core-text-tutorial-ios-making-magazine-app" target="_blank" rel="external">https://www.raywenderlich.com/153591/core-text-tutorial-ios-making-magazine-app</a></p>
<p>Core Text 是一个底层文本引擎，当与 Core Graphics/ Quartz 框架一起使用时，它可以对布局和格式进行细粒度的控制。</p>
<p>在 iOS 7 时候，Apple 发布了 TextKit 类库，它可以存储、列出和显示带有各种排版特征的文本。虽然 TextKit 功能强大，在布局文本时已经足够强大，但相对而言， Core Text  可以提供更多的控制。例如，如果你需要直接使用 Quartz，那么 Core Text 就可以。如果你需要构建自己的布局引擎，Core Text 将帮助你生成 “字形”，并将它们相对地放置在精细排版中。</p>
<p>本教程通过使用 Core Text 创建一个非常简的单杂志应用… Zombies !</p>
<h5 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h5><p>打开 Xcode ，基于  Single View Application Template 创建一个新的 Swift universal project ，并命名为 CoreTextMagazine。</p>
<p>然后，添加 Core Text framework 到我们的工程中:</p>
<ol>
<li>单击项目导航器中的项目文件。</li>
<li>在 “General” 下，滚动到下面的 “Linked Frameworks and Libraries”。</li>
<li>单击 “+”, 并搜索 “CoreText”。</li>
<li>选择 “CoreText.framework” ，然后单击 “Add” 按钮。</li>
</ol>
<p>现在工程已经建好了，是时候开始编码了。</p>
<h5 id="添加一个-Core-Text-View"><a href="#添加一个-Core-Text-View" class="headerlink" title="添加一个 Core Text View"></a>添加一个 Core Text View</h5><p>作为开始，我们将创建一个 UIView，在它的 draw(_:) 方法内将使用 Core Text。</p>
<p>创建一个 Cocoa Touch Class 文件，它继承自 UIView 。将其命名为 CTView 。</p>
<p>打开 CTView.swift，添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import CoreText</span><br></pre></td></tr></table></figure>
<p>而后，设置这个自定义的 view 为应用的主视图。打开 Main.storyboard，打开右边的 Utilities 菜单，选中它上边 toolbar 的 Identity Inspector 按钮，Interface Builder 左边菜单，选中 View。Utilities 菜单的 Class 文本框现在应该为 UIView。键入文本框 CTView ,将其设置为主视图控制器的 View。 </p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-b81fc48cba058237.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>然后，打开 CTView.swift ，替换方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//1	 	 </span><br><span class="line">override func draw(_ rect: CGRect) &#123;	 	 </span><br><span class="line">  // 2	 	 </span><br><span class="line">  guard let context = UIGraphicsGetCurrentContext() else &#123; return &#125;	 	 </span><br><span class="line">  // 3	 	 </span><br><span class="line">  let path = CGMutablePath()	 	 </span><br><span class="line">  path.addRect(bounds)	 	 </span><br><span class="line">  // 4</span><br><span class="line">  let attrString = NSAttributedString(string: &quot;Hello World&quot;)</span><br><span class="line">  // 5</span><br><span class="line">  let framesetter = CTFramesetterCreateWithAttributedString(attrString as CFAttributedString)</span><br><span class="line">  // 6</span><br><span class="line">  let frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(0, attrString.length), path, nil) </span><br><span class="line">  // 7</span><br><span class="line">  CTFrameDraw(frame, context)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>让我逐行解释下上面的代码。</p>
<ol>
<li>一旦 view 创建，draw(_:) 将自动执行来渲染 view 下的 layer。</li>
<li>打开我们将用于绘图的当前图形上下文。</li>
<li>创建一个路径，该路径限制绘图区域，整个视图的边界在该控制下。</li>
<li>在 Core Text 中，使用 NSAttributedString 来保存文本及其属性，而不是 String 或 NSString。初始 “Hello World” 作为一个带属性的字符串。</li>
<li>CTFramesetterCreateWithAttributedString 创建一个使用提供的属性字符串的 CTFramesetter，CTFramesetter 将管理我们的字体引用和绘图框架。</li>
<li>创建 CTFrame，通过拥有 CTFramesetterCreateFrame 使整个字符串在路径中呈现。</li>
<li>CTFrameDraw 在给定的上下文中绘制 CTFrame 。</li>
</ol>
<p>这就是我们要绘制一些简单的文字所需要的所有步骤。 Build and Run，我们可以看到运行结果。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-30bed60d71a29635.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>Uh-oh…  这似乎哪里不对，不是吗？和许多低级 api 一样，Core Text 使用了一个 “y -翻转” 坐标系。更糟糕的是，内容也跟着垂直翻转了!</p>
<p>在 guard let context 代码下面添加如下代码，解决方向错乱问题：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// Flip the coordinate system</span><br><span class="line">context.textMatrix = .identity</span><br><span class="line">context.translateBy(x: 0, y: bounds.size.height)</span><br><span class="line">context.scaleBy(x: 1.0, y: -1.0)</span><br></pre></td></tr></table></figure></p>
<p>此代码通过向视图的上下文中应用转换来翻转内容。</p>
<p>Build and run 应用。先忽略状态栏的重叠，以后我们将会学习如何解决这个问题。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-003a19f11ad8c9a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>恭喜，我们已经创建了属于自己的第一个 Core Text 应用。</p>
<h5 id="Core-Text-Object-Model"><a href="#Core-Text-Object-Model" class="headerlink" title="Core Text Object Model"></a>Core Text Object Model</h5><p>如果你对 CTFramesetter 和 CTFrame 有点困惑，没关系，我们现在讲解一下它。</p>
<p>以下为 Core Text 对象模型的样子:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-62e6d5486c4d55d1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Core Text Class Hierarchy" title="Core Text Class Hierarchy"></p>
<p>当我们创建一个 CTFramesetter 引用并为它提供一个 NSAttributedString 时，将自动创建一个 CTTypesetter 实例来管理字体。接下来，使用 CTFramesetter 创建一个或多个将呈现文本的框架。</p>
<p>当我们创建一个 frame 时，我们提供文本的 subrange，并在它的矩形内渲染文本。Core Text 自动为每一行文本创建一个 CTLine，每段文本 的 CTLine 有相同的格式。例如，如果在一行中有多个红色单词，Core Text 将为这几个词创建一个 CTRun，然后为剩下的纯文本创建另一个 CTRun，再为另一些粗体的词句创建一个 CTRun，等等。此外，Core Text 根据提供的 NSAttributedString 的属性为我们创建 CTRuns。每一个 CTRuns 控件都可以采用不同的属性，因此我们可以对 kerning、ligUNK、width、height 等属性进行很好的控制。</p>
<h5 id="Onto-the-Magazine-App"><a href="#Onto-the-Magazine-App" class="headerlink" title="Onto the Magazine App!"></a>Onto the Magazine App!</h5><p>下载资源压缩包<a href="http://www.raywenderlich.com/downloads/zombieMagMaterials.zip" target="_blank" rel="external">the zombie magazine materials</a>.</p>
<p>拖拽文件夹到我们的 Xcode 工程中，当弹框提醒的时候，确定  Copy items if needed 和 Create groups 是选中的。 </p>
<p>创建 app ，我们需要将各种属性应用于文本。我们将创建一个简单的文本标记解析器，它将使用标记来设置杂志的格式。</p>
<p>创建一个新的 Cocoa Touch 类，让它继承自 NSObject ，命名为 MarkupParser。</p>
<p>首先，快速浏览一下 zombies.txt。看看它是如何在文本中包含有括号的格式标记的。 “img src” 标签指向杂志图片和 “font color/face” 标签决定文本颜色和字体。</p>
<p>打开 MarkupParser.swift 文件，替换如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import UIKit</span><br><span class="line">import CoreText</span><br><span class="line"></span><br><span class="line">class MarkupParser: NSObject &#123;</span><br><span class="line">  </span><br><span class="line">  // MARK: - Properties</span><br><span class="line">  var color: UIColor = .black</span><br><span class="line">  var fontName: String = &quot;Arial&quot;</span><br><span class="line">  var attrString: NSMutableAttributedString!</span><br><span class="line">  var images: [[String: Any]] = []</span><br><span class="line"></span><br><span class="line">  // MARK: - Initializers</span><br><span class="line">  override init() &#123;</span><br><span class="line">    super.init()</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // MARK: - Internal</span><br><span class="line">  func parseMarkup(_ markup: String) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这里添加属性，用来保存字体和文本颜色;设置默认值;创建一个变量来保存 parseMarkup(_:) 产生的属性字符串;并创建了一个数组，它最终将保存字典信息，定义在文本中发现的图像的大小、位置和文件名。</p>
<p>编写解析器通常很困难，但本教程的解析器非常简单，只支持打开标签——这意味着标签将设置文本的样式，直到找到新的标记为止。文本标记将是这样的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">These are &lt;font color=&quot;red&quot;&gt;red&lt;font color=&quot;black&quot;&gt; and</span><br><span class="line">&lt;font color=&quot;blue&quot;&gt;blue &lt;font color=&quot;black&quot;&gt;words.</span><br></pre></td></tr></table></figure></p>
<p>输出像这样：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-c5ae4459e9d4eb55.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>添加如下方法到 parseMarkup(_:): </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//1</span><br><span class="line">attrString = NSMutableAttributedString(string: &quot;&quot;)</span><br><span class="line">//2 </span><br><span class="line">do &#123;</span><br><span class="line">  let regex = try NSRegularExpression(pattern: &quot;(.*?)(&lt;[^&gt;]+&gt;|\\Z)&quot;,</span><br><span class="line">                                      options: [.caseInsensitive,</span><br><span class="line">                                                .dotMatchesLineSeparators])</span><br><span class="line">  //3</span><br><span class="line">  let chunks = regex.matches(in: markup, </span><br><span class="line">                             options: NSRegularExpression.MatchingOptions(rawValue: 0), </span><br><span class="line">                             range: NSRange(location: 0,</span><br><span class="line">                                            length: markup.characters.count))</span><br><span class="line">&#125; catch _ &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>attrString开始是空的，但最终会包含解析后的标记。</li>
<li>这个正则表达式,它意思是说，“通过字符串查找，直到找到一个开头的括号，然后查看字符串，直到找到一个结束括号(或者文档的末尾)。”</li>
<li>搜索 regex 匹配的整个标记范围，然后生成一个 NSTextCheckingResults 结果数组。</li>
</ol>
<blockquote>
<p>注：想更多了解正则表达式，看这里 <a href="https://www.raywenderlich.com/86205/nsregularexpression-swift-tutorial" target="_blank" rel="external">NSRegularExpression Tutorial</a>.</p>
</blockquote>
<p>现在我们已经将所有文本和格式化标记解析成块，接下来我们将遍历块来构建属性字符串。</p>
<p>但在此之前，我们是否注意到如何匹配 (in:options:range:) 接受一个 NSRange 作为参数呢?当你将 ns 正则表达式函数应用于你的标记字符串时，将会有很多 NSRange 到 Range 转换。Swift 一直是我们所有人的好朋友，关键时刻，它给予我们帮助。</p>
<p>在 MarkupParser.swift 中，将下面的扩展添加到文件的末尾：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// MARK: - String</span><br><span class="line">extension String &#123;</span><br><span class="line">  func range(from range: NSRange) -&gt; Range&lt;String.Index&gt;? &#123;</span><br><span class="line">    guard let from16 = utf16.index(utf16.startIndex,</span><br><span class="line">                                   offsetBy: range.location,</span><br><span class="line">                                   limitedBy: utf16.endIndex),</span><br><span class="line">      let to16 = utf16.index(from16, offsetBy: range.length, limitedBy: utf16.endIndex),</span><br><span class="line">      let from = String.Index(from16, within: self),</span><br><span class="line">      let to = String.Index(to16, within: self) else &#123;</span><br><span class="line">        return nil</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">    return from ..&lt; to</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>该函数将字符串的开始和结束索引转换为由 NSRange表示的字符串，String.UTF16View.Index 格式，即字符串中 utf - 16 代码单元集合中的位置; 然后转换每个  String.UTF16View.Index 到 String.Index 格式。只要索引是有效的，该方法将返回代表原 NSRange的 Range。</p>
<p>现在是返回处理文本和标记块的时间了。</p>
<p>在 parseMarkup(_:) 内添加以下  let chunks (在do块内):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let defaultFont: UIFont = .systemFont(ofSize: UIScreen.main.bounds.size.height / 40)</span><br><span class="line">//1</span><br><span class="line">for chunk in chunks &#123;  </span><br><span class="line">  //2</span><br><span class="line">  guard let markupRange = markup.range(from: chunk.range) else &#123; continue &#125;</span><br><span class="line">  //3    </span><br><span class="line">  let parts = markup[markupRange].components(separatedBy: &quot;&lt;&quot;)</span><br><span class="line">  //4</span><br><span class="line">  let font = UIFont(name: fontName, size: UIScreen.main.bounds.size.height / 40) ?? defaultFont       </span><br><span class="line">  //5</span><br><span class="line">  let attrs = [NSAttributedStringKey.foregroundColor: color, NSAttributedStringKey.font: font] as [NSAttributedStringKey : Any]</span><br><span class="line">  let text = NSMutableAttributedString(string: parts[0], attributes: attrs)</span><br><span class="line">  attrString.append(text)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>循环遍历 chunks.</li>
<li>获取当前的 NSTextCheckingResult 的范围，打开Range<string.index> ，只要存在，就继续进行。</string.index></li>
<li>将块分成 “&lt;” 分隔的部分。第一部分包含杂志文本，第二部分包含标签(如果存在的话)。</li>
<li>创建一个使用 fontName 的字体，默认情况下是 “Arial”，创建一个与设备屏幕相等的大小。如果 fontName 没有生成有效的 UIFont，则将字体设置为默认字体。</li>
<li>创建一个字体格式的字典，将它应用于 parts[0] 来创建带属性的字符串，然后将该字符串附加到结果字符串。</li>
</ol>
<p>要处理 “font” tag，请在 attrString.append(text): 后插入以下内容:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// 1</span><br><span class="line">if parts.count &lt;= 1 &#123;</span><br><span class="line">  continue</span><br><span class="line">&#125;</span><br><span class="line">let tag = parts[1]</span><br><span class="line">//2</span><br><span class="line">if tag.hasPrefix(&quot;font&quot;) &#123;</span><br><span class="line">  let colorRegex = try NSRegularExpression(pattern: &quot;(?&lt;=color=\&quot;)\\w+&quot;, </span><br><span class="line">                                           options: NSRegularExpression.Options(rawValue: 0))</span><br><span class="line">  colorRegex.enumerateMatches(in: tag, </span><br><span class="line">    options: NSRegularExpression.MatchingOptions(rawValue: 0), </span><br><span class="line">    range: NSMakeRange(0, tag.characters.count)) &#123; (match, _, _) in</span><br><span class="line">      //3</span><br><span class="line">      if let match = match,</span><br><span class="line">        let range = tag.range(from: match.range) &#123;</span><br><span class="line">          let colorSel = NSSelectorFromString(tag[range]+&quot;Color&quot;)</span><br><span class="line">          color = UIColor.perform(colorSel).takeRetainedValue() as? UIColor ?? .black</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  //5    </span><br><span class="line">  let faceRegex = try NSRegularExpression(pattern: &quot;(?&lt;=face=\&quot;)[^\&quot;]+&quot;,</span><br><span class="line">                                          options: NSRegularExpression.Options(rawValue: 0))</span><br><span class="line">  faceRegex.enumerateMatches(in: tag, </span><br><span class="line">    options: NSRegularExpression.MatchingOptions(rawValue: 0), </span><br><span class="line">    range: NSMakeRange(0, tag.characters.count)) &#123; (match, _, _) in</span><br><span class="line"></span><br><span class="line">      if let match = match,</span><br><span class="line">        let range = tag.range(from: match.range) &#123;</span><br><span class="line">          fontName = String(tag[range])</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; //end of font parsing</span><br></pre></td></tr></table></figure></p>
<ol>
<li>如果 parts.count 小于2，跳过循环体的其余部分。否则，将第二部分存储为 tag。</li>
<li><p>如果 tag 以 “font” 开始，创建一个 regex 来查找字体的 “color” 值，然后使用该 regex 通过标记的匹配 “color” 值来枚举。在本例中，应该只有一个匹配的颜色值。</p>
</li>
<li><p>如果  enumerateMatches(in:options:range:using:) 返回一个有效的 match , match 中含有一个有效的 tag,查找指定的值(ex . <font color="red"> returns “ red “)，并追加” color “以形成UIColor选择器。</font></p>
</li>
<li>同样，创建一个 regex 来处理字体的 “face” 值。如果找到匹配，则将 fontName 设置为该字符串。</li>
</ol>
<p>Great job! 现在，parseMarkup(<em>:) 可以获取标记并为Core Text 生成一个NSAttributedString。<br>现在是时候把你的应用程序喂给一些僵尸了!我的意思是，给你的应用喂一些僵尸… zombies.txt )<br>它实际上是一个 UIView 的工作，显示给它的内容，而不是载入内容。打开 CTView.swift 并添加以下的draw(</em>:):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// MARK: - Properties</span><br><span class="line">var attrString: NSAttributedString!</span><br><span class="line"></span><br><span class="line">// MARK: - Internal</span><br><span class="line">func importAttrString(_ attrString: NSAttributedString) &#123;</span><br><span class="line">  self.attrString = attrString</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>接下来，从 draw(_:) 中删除 attrString = NSAttributedString(string: “Hello World”)。</p>
<p>在这里，我们创建了一个实例变量来保存带属性的字符串，以及将其从 app 的其他地方设置的方法。</p>
<p>接下来, 打开 ViewController.wift 并将以下内容添加到viewDidLoad():<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 1</span><br><span class="line">guard let file = Bundle.main.path(forResource: &quot;zombies&quot;, ofType: &quot;txt&quot;) else &#123; return &#125;</span><br><span class="line">  </span><br><span class="line">do &#123;</span><br><span class="line">  let text = try String(contentsOfFile: file, encoding: .utf8)</span><br><span class="line">  // 2</span><br><span class="line">  let parser = MarkupParser()</span><br><span class="line">  parser.parseMarkup(text)</span><br><span class="line">  (view as? CTView)?.importAttrString(parser.attrString)</span><br><span class="line">&#125; catch _ &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>详解如下：</p>
<ol>
<li>加载 zombie.txt 中的文本到一个 String。</li>
<li>创建一个新的解析器，在文本中输入，然后将返回的属性字符串传递给 ViewController 的 CTView。</li>
</ol>
<p>Build and run the app!</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-a86f3c33c7da876d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>太棒了！得助于 50 行解析代码，我们可以简单地使用一个文本文件来保存杂志应用程序的内容了。</p>
<h5 id="A-Basic-Magazine-Layout"><a href="#A-Basic-Magazine-Layout" class="headerlink" title="A Basic Magazine Layout"></a>A Basic Magazine Layout</h5><p>如果你认为一个僵尸新闻的月杂志可以放到一个微不足道的页面上，那你就大错特错了! 幸运的是 Core Text 布局列时尤为有用， CTFrameGetVisibleStringRange 可以告诉我们多少文本将适合一个给定的框架。也就是说，你可以创建一个列，然后当它的全部被填充后，你可以再创建另一个列，等等。</p>
<p>对于这个 app，你必须打印列，然后是页面，然后是一本完整的杂志，以免冒犯不死族，所以……是时候将 CTView 子类转换为 UIScrollView 了。</p>
<p>打开 CTView.swift 和更改类 CTView 一行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class CTView: UIScrollView &#123;</span><br></pre></td></tr></table></figure></p>
<p>看到僵尸了吧? 这个应用现在可以支持不死的冒险了! 是的——仅仅一行代码，就可以滚动和分页了。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-7c53a90bfc88bd52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="happy zombie"></p>
<p>到目前为止，我们已经创建了框架和框架内 draw(_:)，但是由于我们有许多不同格式的列，所以最好创建单独的列实例。</p>
<p>创建一个新的 Cocoa Touch 类文件，命名为 CTColumnView，令它继承自 UIView。</p>
<p>打开 CTColumnView.swift，添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import UIKit</span><br><span class="line">import CoreText</span><br><span class="line"></span><br><span class="line">class CTColumnView: UIView &#123;</span><br><span class="line">  </span><br><span class="line">  // MARK: - Properties</span><br><span class="line">  var ctFrame: CTFrame!</span><br><span class="line">  </span><br><span class="line">  // MARK: - Initializers</span><br><span class="line">  required init(coder aDecoder: NSCoder) &#123;</span><br><span class="line">    super.init(coder: aDecoder)!</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  required init(frame: CGRect, ctframe: CTFrame) &#123;</span><br><span class="line">    super.init(frame: frame)</span><br><span class="line">    self.ctFrame = ctframe</span><br><span class="line">    backgroundColor = .white</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // MARK: - Life Cycle</span><br><span class="line">  override func draw(_ rect: CGRect) &#123;</span><br><span class="line">    guard let context = UIGraphicsGetCurrentContext() else &#123; return &#125;</span><br><span class="line">      </span><br><span class="line">    context.textMatrix = .identity</span><br><span class="line">    context.translateBy(x: 0, y: bounds.size.height)</span><br><span class="line">    context.scaleBy(x: 1.0, y: -1.0)</span><br><span class="line">      </span><br><span class="line">    CTFrameDraw(ctFrame, context)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段代码呈现的是 CTFrame，就像我们之前在 CTView 中所做的那样。自定义初始化程序，init(框架:ctframe:) 集合:</p>
<ol>
<li>The view’s frame.</li>
<li>在上下文渲染的 CTFrame。</li>
<li>设置 view 的背景颜色为白色。</li>
</ol>
<p>接下来，创建一个名为 CTSettings.swift 的新的文件，它用来进行列设置。</p>
<p>用以下代码替换 CTSettings.swift 内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import UIKit</span><br><span class="line">import Foundation</span><br><span class="line"></span><br><span class="line">class CTSettings &#123;</span><br><span class="line">  //1</span><br><span class="line">  // MARK: - Properties</span><br><span class="line">  let margin: CGFloat = 20</span><br><span class="line">  var columnsPerPage: CGFloat!</span><br><span class="line">  var pageRect: CGRect!</span><br><span class="line">  var columnRect: CGRect!</span><br><span class="line">  </span><br><span class="line">  // MARK: - Initializers</span><br><span class="line">  init() &#123;</span><br><span class="line">    //2</span><br><span class="line">    columnsPerPage = UIDevice.current.userInterfaceIdiom == .phone ? 1 : 2</span><br><span class="line">    //3</span><br><span class="line">    pageRect = UIScreen.main.bounds.insetBy(dx: margin, dy: margin)</span><br><span class="line">    //4</span><br><span class="line">    columnRect = CGRect(x: 0,</span><br><span class="line">                        y: 0,</span><br><span class="line">                        width: pageRect.width / columnsPerPage,</span><br><span class="line">                        height: pageRect.height).insetBy(dx: margin, dy: margin)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>属性将决定页边距(本教程的默认值为20)，每页的列数，每一页的 frame，每一页 frame 大小。</li>
<li>由于该杂志同时提供 iPhone 和 iPad 上的僵尸，在 iPad 上显示两列，在 iPhone 上显示一列，因此每一个屏幕的大小都是合适的。</li>
<li>设置 pageRect 为 UIScreen.main.bounds.insetBy(dx: margin, dy: margin)。</li>
<li>设置 columnRect 为将 pageRect 的宽度除以每一页的列数，并除去边距。</li>
</ol>
<p>打开 CTView.swift, 做如下替换 :<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import UIKit</span><br><span class="line">import CoreText</span><br><span class="line"></span><br><span class="line">class CTView: UIScrollView &#123;</span><br><span class="line"></span><br><span class="line">  //1</span><br><span class="line">  func buildFrames(withAttrString attrString: NSAttributedString,</span><br><span class="line">                   andImages images: [[String: Any]]) &#123;</span><br><span class="line">    //3</span><br><span class="line">    isPagingEnabled = true</span><br><span class="line">    //4</span><br><span class="line">    let framesetter = CTFramesetterCreateWithAttributedString(attrString as CFAttributedString)</span><br><span class="line">    //4</span><br><span class="line">    var pageView = UIView()</span><br><span class="line">    var textPos = 0</span><br><span class="line">    var columnIndex: CGFloat = 0</span><br><span class="line">    var pageIndex: CGFloat = 0</span><br><span class="line">    let settings = CTSettings()</span><br><span class="line">    //5</span><br><span class="line">    while textPos &lt; attrString.length &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>注释如下：</p>
<ol>
<li>buildFrames(withAttrString:andImages:)  将创建 CTColumnViews，然后添加它们到 scrollview。</li>
<li>启用scrollview的分页功能;每当用户停止滚动时，滚动视图就会快速地显示出一个完整的页面。</li>
<li>CTFramesetter framesetter 将为属性文本创建每个列的CTFrame。</li>
<li>UIView pageViews 作为每个页面的列子视图的容器; textPos 将跟踪下一个字符; columnIndex 将跟踪当前列; pageIndex 将跟踪当前页面; settings 允许你访问应用程序的 margin 大小，每一页的列，page frame 和 column frame 设置。</li>
<li>我们将遍历 attrString 并按列列出文本列，直到当前文本位置到达结束为止。</li>
</ol>
<p>是时候添加  looping attrString 了，在 while textPos &lt; attrString.length {.: 方法内添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//1</span><br><span class="line">if columnIndex.truncatingRemainder(dividingBy: settings.columnsPerPage) == 0 &#123;</span><br><span class="line">  columnIndex = 0</span><br><span class="line">  pageView = UIView(frame: settings.pageRect.offsetBy(dx: pageIndex * bounds.width, dy: 0))</span><br><span class="line">  addSubview(pageView)</span><br><span class="line">  //2</span><br><span class="line">  pageIndex += 1</span><br><span class="line">&#125;   </span><br><span class="line">//3</span><br><span class="line">let columnXOrigin = pageView.frame.size.width / settings.columnsPerPage</span><br><span class="line">let columnOffset = columnIndex * columnXOrigin</span><br><span class="line">let columnFrame = settings.columnRect.offsetBy(dx: columnOffset, dy: 0)</span><br></pre></td></tr></table></figure>
<ol>
<li>如果 column index 被每页的列数相除等于 0 ，则表示该列是其页面上的第一个列，创建一个新的 page视图来保存列。使用边缘 settings.pageRect 设置它的帧。x offset 为当前页 index 乘以屏幕宽度。当页面滚动时，每个杂志页面将位于前一个页面的右侧。</li>
<li>自增 pageIndex。</li>
<li>pageView 的宽度除以  settings.columnsPerPage 获得第一列的 x 坐标; x 坐标乘以 column index 获得列偏移。然后用标准列向量来创建当前列的 frame，并通过 columnOffset 来抵消它的 x 原点。</li>
</ol>
<p>接下来，在 columnFrame initialization 下面添加如下代码。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//1   </span><br><span class="line">let path = CGMutablePath()</span><br><span class="line">path.addRect(CGRect(origin: .zero, size: columnFrame.size))</span><br><span class="line">let ctframe = CTFramesetterCreateFrame(framesetter, CFRangeMake(textPos, 0), path, nil)</span><br><span class="line">//2</span><br><span class="line">let column = CTColumnView(frame: columnFrame, ctframe: ctframe)</span><br><span class="line">pageView.addSubview(column)</span><br><span class="line">//3</span><br><span class="line">let frameRange = CTFrameGetVisibleStringRange(ctframe)</span><br><span class="line">textPos += frameRange.length</span><br><span class="line">//4</span><br><span class="line">columnIndex += 1</span><br></pre></td></tr></table></figure></p>
<ol>
<li>创建一个 CGMutablePath，然后从textPos 开始，呈现一个新的 CTFrame，包含尽可能多的文本。</li>
<li>使用 CGRect columnFrame 和 CTFrame ctframe  创建一个 CTColumnView ，添加列到 pageView。</li>
<li>使用 CTFrameGetVisibleStringRange(_:) 来计算文本列中包含的范围,然后 textPos +frameRange.length 来反映当前文本的位置。</li>
<li>在循环到下一列之前，将列索引增加1。</li>
</ol>
<p>最后，在循环之后设置滚动视图的内容大小：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">contentSize = CGSize(width: CGFloat(pageIndex) * bounds.size.width,</span><br><span class="line">                     height: bounds.size.height)</span><br></pre></td></tr></table></figure></p>
<p>通过将内容大小设置为屏幕宽度乘以页面数，zombies 现在可以滚动到最后了。</p>
<p>打开 ViewController.swift ，替换<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(view as? CTView)?.importAttrString(parser.attrString)</span><br></pre></td></tr></table></figure></p>
<p>为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(view as? CTView)?.buildFrames(withAttrString: parser.attrString, andImages: parser.images)</span><br></pre></td></tr></table></figure></p>
<p>在 iPad 上运行 app，左右拖动到页面之间，检查双列布局。看起来不错.:]</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-68d90c77a0d9eecb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>我们有了列和格式化的文本，但还缺少图像。使用 Core Text  绘制图像并不是那么简单——毕竟它是一个文本框架——但是在我们已经创建的标记解析器的帮助下，添加图像不应该太糟糕。</p>
<h5 id="Drawing-Images-in-Core-Text"><a href="#Drawing-Images-in-Core-Text" class="headerlink" title="Drawing Images in Core Text"></a>Drawing Images in Core Text</h5><p>虽然 Core Text 不能绘制图像，但作为一个布局引擎，它可以留出空白空间来为图像腾出空间。通过设置 CTRun 的 delegate,我们可以确定 CTRun 的 ascent space, descent space and width。像下面这样:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-53c6767f7efbc8b7.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="CTRunDelegate.jpg"></p>
<p>当 Core Text 获得一个带有 CTRunDelegate 的 CTRun 类时，它会询问委托，“我应该留出多少空间来处理这段数据?” 通过在CTRunDelegate中设置这些属性，我们可以在文本中为我们的图像留下空间。</p>
<p>首先，添加 “img” 标签。打开 MarkupParser.swift，找到  “} //end of font parsing”，在其后添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">//1</span><br><span class="line">else if tag.hasPrefix(&quot;img&quot;) &#123; </span><br><span class="line">      </span><br><span class="line">  var filename:String = &quot;&quot;</span><br><span class="line">  let imageRegex = try NSRegularExpression(pattern: &quot;(?&lt;=src=\&quot;)[^\&quot;]+&quot;,</span><br><span class="line">                                           options: NSRegularExpression.Options(rawValue: 0))</span><br><span class="line">  imageRegex.enumerateMatches(in: tag, </span><br><span class="line">    options: NSRegularExpression.MatchingOptions(rawValue: 0), </span><br><span class="line">    range: NSMakeRange(0, tag.characters.count)) &#123; (match, _, _) in</span><br><span class="line"></span><br><span class="line">    if let match = match,</span><br><span class="line">      let range = tag.range(from: match.range) &#123;</span><br><span class="line">        filename = String(tag[range])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  //2</span><br><span class="line">  let settings = CTSettings()</span><br><span class="line">  var width: CGFloat = settings.columnRect.width</span><br><span class="line">  var height: CGFloat = 0</span><br><span class="line"></span><br><span class="line">  if let image = UIImage(named: filename) &#123;</span><br><span class="line">    height = width * (image.size.height / image.size.width)</span><br><span class="line">    // 3</span><br><span class="line">    if height &gt; settings.columnRect.height - font.lineHeight &#123;</span><br><span class="line">      height = settings.columnRect.height - font.lineHeight</span><br><span class="line">      width = height * (image.size.width / image.size.height)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>如果 tag 以 “img” 开始，使用正则表达式寻找 图像的 “src” ,即 filename。</li>
<li>将图像宽设置为列的宽度，并设置其高度，使图像保持其高宽比。</li>
<li>如果图像的高度太长，则设置高为适合的列，并减小宽度以保持图像的纵横比。由于图像后面的文本将包含空的空间属性，包含空空间信息的文本必须与图像匹配在同一列中。设置图像的高度为 settings.columnRect.height - font.lineHeight。</li>
</ol>
<p>接下来，在 if let image 代码块下添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//1</span><br><span class="line">images += [[&quot;width&quot;: NSNumber(value: Float(width)),</span><br><span class="line">            &quot;height&quot;: NSNumber(value: Float(height)),</span><br><span class="line">            &quot;filename&quot;: filename,</span><br><span class="line">            &quot;location&quot;: NSNumber(value: attrString.length)]]</span><br><span class="line">//2</span><br><span class="line">struct RunStruct &#123;</span><br><span class="line">  let ascent: CGFloat</span><br><span class="line">  let descent: CGFloat</span><br><span class="line">  let width: CGFloat</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let extentBuffer = UnsafeMutablePointer&lt;RunStruct&gt;.allocate(capacity: 1)</span><br><span class="line">extentBuffer.initialize(to: RunStruct(ascent: height, descent: 0, width: width))</span><br><span class="line">//3</span><br><span class="line">var callbacks = CTRunDelegateCallbacks(version: kCTRunDelegateVersion1, dealloc: &#123; (pointer) in</span><br><span class="line">&#125;, getAscent: &#123; (pointer) -&gt; CGFloat in</span><br><span class="line">  let d = pointer.assumingMemoryBound(to: RunStruct.self)</span><br><span class="line">  return d.pointee.ascent</span><br><span class="line">&#125;, getDescent: &#123; (pointer) -&gt; CGFloat in</span><br><span class="line">  let d = pointer.assumingMemoryBound(to: RunStruct.self)</span><br><span class="line">  return d.pointee.descent</span><br><span class="line">&#125;, getWidth: &#123; (pointer) -&gt; CGFloat in</span><br><span class="line">  let d = pointer.assumingMemoryBound(to: RunStruct.self)</span><br><span class="line">  return d.pointee.width</span><br><span class="line">&#125;)</span><br><span class="line">//4</span><br><span class="line">let delegate = CTRunDelegateCreate(&amp;callbacks, extentBuffer)</span><br><span class="line">//5</span><br><span class="line">let attrDictionaryDelegate = [(kCTRunDelegateAttributeName as NSAttributedStringKey): (delegate as Any)]              </span><br><span class="line">attrString.append(NSAttributedString(string: &quot; &quot;, attributes: attrDictionaryDelegate))</span><br></pre></td></tr></table></figure>
<ol>
<li>赋值字典给变量 images，字典包含 image’s size, filename and text location。</li>
<li>定义 RunStruct 来保存描述空空间的属性。然后初始化一个指针，以包含一个 ascent 等于图像高度的 RunStruct，以及一个与图像宽度相等的 width 属性。</li>
<li>创建一个 CTRunDelegateCallbacks ，它返回类型指针 RunStruct 的 ascent, descent 以及 width 属性。</li>
<li>使用 CTRunDelegateCreate 创建一个 delegate 实例，来绑定 callbacks 和 参数数据(data parameter)。</li>
<li>创建一个包含 delegate 实例的属性字典，然后赋值空字符串给 attrString, attrString 包含了文本中空洞的位置和大小信息。</li>
</ol>
<p>现在，MarkupParser 正在处理“img”标记，我们需要调整 CTColumnView 和 CTView 来呈现它们。</p>
<p>打开 CTColumnView.swift，在 var ctFrame:CTFrame! 添加如下代码，以此控制列中的图片和frames：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var images: [(image: UIImage, frame: CGRect)] = []</span><br></pre></td></tr></table></figure></p>
<p>接下来，添加如下代码到 draw(_:) 方法的底部:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for imageData in images &#123;</span><br><span class="line">  if let image = imageData.image.cgImage &#123;</span><br><span class="line">    let imgBounds = imageData.frame</span><br><span class="line">    context.draw(image, in: imgBounds)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里我们遍历每个 image 并绘制它到合适的 frame。</p>
<p>接下来，打开 CTView.swift  并在 class 的顶部添加如下属性：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// MARK: - Properties</span><br><span class="line">var imageIndex: Int!</span><br></pre></td></tr></table></figure></p>
<p>当你绘制 CTColumnViews  时，imageIndex 将追踪当前的图像 index。接下来，在 buildFrames(withAttrString:andImages:) 上面添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">imageIndex = 0</span><br></pre></td></tr></table></figure>
<p>这标记 images 数组的第一个元素。</p>
<p>接着，在 buildFrames(withAttrString:andImages:): 下面添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func attachImagesWithFrame(_ images: [[String: Any]],</span><br><span class="line">                           ctframe: CTFrame,</span><br><span class="line">                           margin: CGFloat,</span><br><span class="line">                           columnView: CTColumnView) &#123;</span><br><span class="line">  //1</span><br><span class="line">  let lines = CTFrameGetLines(ctframe) as NSArray</span><br><span class="line">  //2</span><br><span class="line">  var origins = [CGPoint](repeating: .zero, count: lines.count)</span><br><span class="line">  CTFrameGetLineOrigins(ctframe, CFRangeMake(0, 0), &amp;origins)</span><br><span class="line">  //3</span><br><span class="line">  var nextImage = images[imageIndex]</span><br><span class="line">  guard var imgLocation = nextImage[&quot;location&quot;] as? Int else &#123;</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line">  //4</span><br><span class="line">  for lineIndex in 0..&lt;lines.count &#123;</span><br><span class="line">    let line = lines[lineIndex] as! CTLine</span><br><span class="line">    //5</span><br><span class="line">    if let glyphRuns = CTLineGetGlyphRuns(line) as? [CTRun], </span><br><span class="line">      let imageFilename = nextImage[&quot;filename&quot;] as? String, </span><br><span class="line">      let img = UIImage(named: imageFilename)  &#123; </span><br><span class="line">        for run in glyphRuns &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>获取 ctframe’s CTLine objects 的数组。</li>
<li>使用 CTFrameGetOrigins  拷贝 ctframe’s line origins 到 origins array。通过设置 range length 为 0，CTFrameGetOrigins 知道穿越整个 CTFrame。</li>
<li>设置 nextImage 来包含当前图像的属性数据。如果 nextImage 包含图像的位置，打开它并继续;否则,提前返回。</li>
<li>循环遍历 text’s lines 。</li>
<li>如果  line’s glyph runs, filename 和 filename 的image 都存在，循环  glyph runs 。</li>
</ol>
<p>接下来，添加如下代码到 for-loop:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 1</span><br><span class="line">let runRange = CTRunGetStringRange(run)    </span><br><span class="line">if runRange.location &gt; imgLocation || runRange.location + runRange.length &lt;= imgLocation &#123;</span><br><span class="line">  continue</span><br><span class="line">&#125;</span><br><span class="line">//2</span><br><span class="line">var imgBounds: CGRect = .zero</span><br><span class="line">var ascent: CGFloat = 0       </span><br><span class="line">imgBounds.size.width = CGFloat(CTRunGetTypographicBounds(run, CFRangeMake(0, 0), &amp;ascent, nil, nil))</span><br><span class="line">imgBounds.size.height = ascent</span><br><span class="line">//3</span><br><span class="line">let xOffset = CTLineGetOffsetForStringIndex(line, CTRunGetStringRange(run).location, nil)</span><br><span class="line">imgBounds.origin.x = origins[lineIndex].x + xOffset </span><br><span class="line">imgBounds.origin.y = origins[lineIndex].y</span><br><span class="line">//4</span><br><span class="line">columnView.images += [(image: img, frame: imgBounds)]</span><br><span class="line">//5</span><br><span class="line">imageIndex! += 1</span><br><span class="line">if imageIndex &lt; images.count &#123;</span><br><span class="line">  nextImage = images[imageIndex]</span><br><span class="line">  imgLocation = (nextImage[&quot;location&quot;] as AnyObject).intValue</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>如果当前运行的范围不包含下一个图像，则跳过循环其余部分。否则，在这里渲染图像。</li>
<li>使用 CTRunGetTypographicBounds 计算 image width, 将 width 赋值给 ascent。</li>
<li>使用  CTLineGetOffsetForStringIndex 获取 line 的 x offset，然后添加它到 imgBounds’ origin。</li>
<li>添加 image 和它的 frame到当前 CTColumnView。</li>
<li>增加 imageIndex。如果有图像在 imges 数组中，更新 nextImage 和 imgLocation，以便它们指向下一个图像。</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-920b9ba78a9bce53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>OK! Great! 只剩下最后一步了。</p>
<p>在方法 buildFrames(withAttrString:andImages:) 中pageView.addSubview(column) 的上部添加如下代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if images.count &gt; imageIndex &#123;</span><br><span class="line">  attachImagesWithFrame(images, ctframe: ctframe, margin: settings.margin, columnView: column)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果它们存在，附加图像。</p>
<p>在 iPhone 和 iPad 上面运行，效果如下：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/130752-e1515d29ef981151.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>恭喜，大功告成。</p>

          
        
      
    </div>
    
    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="Joey Chang" />
          <p class="site-author-name" itemprop="name">Joey Chang</p>
          <p class="site-description motion-element" itemprop="description">读书、写字、周游天下...</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">61</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/iJoeychang" target="_blank">
                  
                    <i class="fa fa-globe"></i>
                  
                  github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/users/9a969b4dae83/latest_articles" target="_blank">
                  
                    <i class="fa fa-home"></i>
                  
                  简书
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/3490688707" target="_blank">
                  
                    <i class="fa fa-globe"></i>
                  
                  weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Joey Chang</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

本站总访问量 <span id="busuanzi_value_site_pv"></span> &nbsp&nbsp&nbsp
您是第<span id="busuanzi_value_site_uv"></span>位到访者



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"joeychang"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  


  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>



</body>
</html>
